const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./DP9xwUSQ.js","./BosuxZz1.js"])))=>i.map(i=>d[i]);
import{W as Me,r as ve,X as Ks,K as $,l as Et,Y as cs,Z as Gs,$ as ie,d as Ot,a0 as hs,M as ds,N as He,a1 as Ws,a2 as Zs,o as fs,a3 as Ys,L as $e,c as A,e as j,f as qe,P as ee,O as B,n as R,h as zt,g as ge,a4 as Qs,a5 as ps,a6 as Ve,a7 as ce,F as Ee,k as Oe,t as Te,a8 as Xs,b as er,a9 as tr,aa as sr,_ as _e}from"./77kVjPu9.js";import{g as rr,a as ir,c as L}from"./BosuxZz1.js";const nr={wrapper:"",inner:"",label:{wrapper:"flex content-center items-center justify-between",base:"block font-medium text-gray-700 dark:text-gray-200",required:"after:content-['*'] after:ms-0.5 after:text-red-500 dark:after:text-red-400"},size:{"2xs":"text-xs",xs:"text-xs",sm:"text-sm",md:"text-sm",lg:"text-sm",xl:"text-base"},container:"mt-1 relative",description:"text-gray-500 dark:text-gray-400",hint:"text-gray-500 dark:text-gray-400",help:"mt-2 text-gray-500 dark:text-gray-400",error:"mt-2 text-red-500 dark:text-red-400",default:{size:"sm"}},ar=(r,e)=>{const t=Me("form-events",void 0),s=Me("form-group",void 0),i=Me("form-inputs",void 0);s&&(r!=null&&r.id&&(s.inputId.value=r==null?void 0:r.id),i&&(i.value[s.name.value]=s.inputId.value));const n=ve(!1);function a(u,h){t&&t.emit({type:u,path:h})}function o(){a("blur",s==null?void 0:s.name.value),n.value=!0}function l(){a("change",s==null?void 0:s.name.value)}const c=Ks(()=>{(n.value||s!=null&&s.eagerValidation.value)&&a("input",s==null?void 0:s.name.value)},300);return{inputId:$(()=>(r==null?void 0:r.id)??(s==null?void 0:s.inputId.value)),name:$(()=>(r==null?void 0:r.name)??(s==null?void 0:s.name.value)),size:$(()=>{var h;const u=e.size[s==null?void 0:s.size.value]?s==null?void 0:s.size.value:null;return(r==null?void 0:r.size)??u??((h=e==null?void 0:e.default)==null?void 0:h.size)}),color:$(()=>{var u;return(u=s==null?void 0:s.error)!=null&&u.value?"red":r==null?void 0:r.color}),emitFormBlur:o,emitFormInput:c,emitFormChange:l}},V=cs(ie.ui.strategy,ie.ui.input,Gs),or=Ot({components:{UIcon:hs},inheritAttrs:!1,props:{modelValue:{type:[String,Number],default:""},type:{type:String,default:"text"},id:{type:String,default:null},name:{type:String,default:null},placeholder:{type:String,default:null},required:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},autofocus:{type:Boolean,default:!1},autofocusDelay:{type:Number,default:100},icon:{type:String,default:null},loadingIcon:{type:String,default:()=>V.default.loadingIcon},leadingIcon:{type:String,default:null},trailingIcon:{type:String,default:null},trailing:{type:Boolean,default:!1},leading:{type:Boolean,default:!1},loading:{type:Boolean,default:!1},padded:{type:Boolean,default:!0},size:{type:String,default:null,validator(r){return Object.keys(V.size).includes(r)}},color:{type:String,default:()=>V.default.color,validator(r){return[...ie.ui.colors,...Object.keys(V.color)].includes(r)}},variant:{type:String,default:()=>V.default.variant,validator(r){return[...Object.keys(V.variant),...Object.values(V.color).flatMap(e=>Object.keys(e))].includes(r)}},inputClass:{type:String,default:null},class:{type:[String,Object,Array],default:()=>""},ui:{type:Object,default:()=>({})},modelModifiers:{type:Object,default:()=>({})}},emits:["update:modelValue","blur","change"],setup(r,{emit:e,slots:t}){const{ui:s,attrs:i}=ds("input",He(r,"ui"),V,He(r,"class")),{size:n,rounded:a}=Ws({ui:s,props:r}),{emitFormBlur:o,emitFormInput:l,size:c,color:u,inputId:h,name:d}=ar(r,V),f=$(()=>n.value||c.value),p=ve(Zs({},r.modelModifiers,{trim:!1,lazy:!1,number:!1})),g=ve(null),m=()=>{var b;r.autofocus&&((b=g.value)==null||b.focus())},w=b=>{p.value.trim&&(b=b.trim()),(p.value.number||r.type==="number")&&(b=Qs(b)),e("update:modelValue",b),l()},S=b=>{p.value.lazy||w(b.target.value)},x=b=>{if(r.type==="file"){const K=b.target.files;e("change",K)}else{const K=b.target.value;e("change",K),p.value.lazy&&w(K),p.value.trim&&(b.target.value=K.trim())}},E=b=>{o(),e("blur",b)};fs(()=>{setTimeout(()=>{m()},r.autofocusDelay)});const O=$(()=>{var K,Nt;const b=((Nt=(K=s.value.color)==null?void 0:K[u.value])==null?void 0:Nt[r.variant])||s.value.variant[r.variant];return Ys($e(s.value.base,s.value.form,a.value,s.value.placeholder,r.type==="file"&&s.value.file.base,s.value.size[f.value],r.padded?s.value.padding[f.value]:"p-0",b==null?void 0:b.replaceAll("{color}",u.value),(H.value||t.leading)&&s.value.leading.padding[f.value],(Se.value||t.trailing)&&s.value.trailing.padding[f.value]),r.inputClass)}),H=$(()=>r.icon&&r.leading||r.icon&&!r.trailing||r.loading&&!r.trailing||r.leadingIcon),Se=$(()=>r.icon&&r.trailing||r.loading&&r.trailing||r.trailingIcon),Ut=$(()=>r.loading?r.loadingIcon:r.leadingIcon||r.icon),ue=$(()=>r.loading&&!H.value?r.loadingIcon:r.trailingIcon||r.icon),De=$(()=>$e(s.value.icon.leading.wrapper,s.value.icon.leading.pointer,s.value.icon.leading.padding[f.value])),k=$(()=>$e(s.value.icon.base,u.value&&ie.ui.colors.includes(u.value)&&s.value.icon.color.replaceAll("{color}",u.value),s.value.icon.size[f.value],r.loading&&s.value.icon.loading)),q=$(()=>$e(s.value.icon.trailing.wrapper,s.value.icon.trailing.pointer,s.value.icon.trailing.padding[f.value])),Le=$(()=>$e(s.value.icon.base,u.value&&ie.ui.colors.includes(u.value)&&s.value.icon.color.replaceAll("{color}",u.value),s.value.icon.size[f.value],r.loading&&!H.value&&s.value.icon.loading));return{ui:s,attrs:i,name:d,inputId:h,input:g,isLeading:H,isTrailing:Se,inputClass:O,leadingIconName:Ut,leadingIconClass:k,leadingWrapperIconClass:De,trailingIconName:ue,trailingIconClass:Le,trailingWrapperIconClass:q,onInput:S,onChange:x,onBlur:E}}}),lr=["id","name","value","type","required","placeholder","disabled"];function ur(r,e,t,s,i,n){const a=hs;return A(),j("div",{class:R(r.type==="hidden"?"hidden":r.ui.wrapper)},[qe("input",ee({id:r.inputId,ref:"input",name:r.name,value:r.modelValue,type:r.type,required:r.required,placeholder:r.placeholder,disabled:r.disabled,class:r.inputClass},r.attrs,{onInput:e[0]||(e[0]=(...o)=>r.onInput&&r.onInput(...o)),onBlur:e[1]||(e[1]=(...o)=>r.onBlur&&r.onBlur(...o)),onChange:e[2]||(e[2]=(...o)=>r.onChange&&r.onChange(...o))}),null,16,lr),B(r.$slots,"default"),r.isLeading&&r.leadingIconName||r.$slots.leading?(A(),j("span",{key:0,class:R(r.leadingWrapperIconClass)},[B(r.$slots,"leading",{disabled:r.disabled,loading:r.loading},()=>[zt(a,{name:r.leadingIconName,class:R(r.leadingIconClass)},null,8,["name","class"])])],2)):ge("",!0),r.isTrailing&&r.trailingIconName||r.$slots.trailing?(A(),j("span",{key:1,class:R(r.trailingWrapperIconClass)},[B(r.$slots,"trailing",{disabled:r.disabled,loading:r.loading},()=>[zt(a,{name:r.trailingIconName,class:R(r.trailingIconClass)},null,8,["name","class"])])],2)):ge("",!0)],2)}const Oa=Et(or,[["render",ur]]),at=cs(ie.ui.strategy,ie.ui.formGroup,nr),cr=Ot({inheritAttrs:!1,props:{name:{type:String,default:null},size:{type:String,default:null,validator(r){return Object.keys(at.size).includes(r)}},label:{type:String,default:null},description:{type:String,default:null},required:{type:Boolean,default:!1},help:{type:String,default:null},error:{type:[String,Boolean],default:null},hint:{type:String,default:null},class:{type:[String,Object,Array],default:()=>""},ui:{type:Object,default:()=>({})},eagerValidation:{type:Boolean,default:!1}},setup(r){const{ui:e,attrs:t}=ds("formGroup",He(r,"ui"),at,He(r,"class")),s=Me("form-errors",null),i=$(()=>{var o,l;return r.error&&typeof r.error=="string"||typeof r.error=="boolean"?r.error:(l=(o=s==null?void 0:s.value)==null?void 0:o.find(c=>c.path===r.name))==null?void 0:l.message}),n=$(()=>e.value.size[r.size??at.default.size]),a=ve(ps("$K7dDJpdOWE"));return Ve("form-group",{error:i,inputId:a,name:$(()=>r.name),size:$(()=>r.size),eagerValidation:$(()=>r.eagerValidation)}),{ui:e,attrs:t,inputId:a,size:n,error:i}}}),hr=["for"];function dr(r,e,t,s,i,n){return A(),j("div",ee({class:r.ui.wrapper},r.attrs),[qe("div",{class:R(r.ui.inner)},[r.label||r.$slots.label?(A(),j("div",{key:0,class:R([r.ui.label.wrapper,r.size])},[qe("label",{for:r.inputId,class:R([r.ui.label.base,r.required?r.ui.label.required:""])},[r.$slots.label?B(r.$slots,"label",ce(ee({key:0},{error:r.error,label:r.label,name:r.name,hint:r.hint,description:r.description,help:r.help}))):(A(),j(Ee,{key:1},[Oe(Te(r.label),1)],64))],10,hr),r.hint||r.$slots.hint?(A(),j("span",{key:0,class:R([r.ui.hint])},[r.$slots.hint?B(r.$slots,"hint",ce(ee({key:0},{error:r.error,label:r.label,name:r.name,hint:r.hint,description:r.description,help:r.help}))):(A(),j(Ee,{key:1},[Oe(Te(r.hint),1)],64))],2)):ge("",!0)],2)):ge("",!0),r.description||r.$slots.description?(A(),j("p",{key:1,class:R([r.ui.description,r.size])},[r.$slots.description?B(r.$slots,"description",ce(ee({key:0},{error:r.error,label:r.label,name:r.name,hint:r.hint,description:r.description,help:r.help}))):(A(),j(Ee,{key:1},[Oe(Te(r.description),1)],64))],2)):ge("",!0)],2),qe("div",{class:R([r.label?r.ui.container:""])},[B(r.$slots,"default",ce(Xs({error:r.error}))),typeof r.error=="string"&&r.error||r.$slots.error?(A(),j("p",{key:0,class:R([r.ui.error,r.size])},[r.$slots.error?B(r.$slots,"error",ce(ee({key:0},{error:r.error,label:r.label,name:r.name,hint:r.hint,description:r.description,help:r.help}))):(A(),j(Ee,{key:1},[Oe(Te(r.error),1)],64))],2)):r.help||r.$slots.help?(A(),j("p",{key:1,class:R([r.ui.help,r.size])},[r.$slots.help?B(r.$slots,"help",ce(ee({key:0},{error:r.error,label:r.label,name:r.name,hint:r.hint,description:r.description,help:r.help}))):(A(),j(Ee,{key:1},[Oe(Te(r.help),1)],64))],2)):ge("",!0)],2)],16)}const Ta=Et(cr,[["render",dr]]);class Ke extends Error{constructor(e){super(e),this.message=e,Object.setPrototypeOf(this,Ke.prototype)}}const fr=Ot({props:{schema:{type:[Object,Function],default:void 0},state:{type:Object,required:!0},validate:{type:Function,default:()=>[]},validateOn:{type:Array,default:()=>["blur","input","change","submit"]}},emits:["submit","error"],setup(r,{expose:e,emit:t}){const s=ps("$Z55GngiEgp"),i=sr(`form-${s}`);fs(()=>{i.on(async u=>{var h;u.type!=="submit"&&((h=r.validateOn)!=null&&h.includes(u.type))&&await l(u.path,{silent:!0})})}),er(()=>{i.reset()});const n=ve([]);Ve("form-errors",n),Ve("form-events",i);const a=ve({});Ve("form-inputs",a);async function o(){let u=await r.validate(r.state);if(r.schema)if(yr(r.schema))u=u.concat(await vr(r.state,r.schema));else if(pr(r.schema))u=u.concat(await mr(r.state,r.schema));else if(_r(r.schema))u=u.concat(await wr(r.state,r.schema));else if(kr(r.schema))u=u.concat(await Sr(r.state,r.schema));else throw new Error("Form validation failed: Unsupported form schema");return u}async function l(u,h={silent:!1}){let d=u;if(u&&!Array.isArray(u)&&(d=[u]),d){const f=n.value.filter(g=>!d.includes(g.path)),p=(await o()).filter(g=>d.includes(g.path));n.value=f.concat(p)}else n.value=await o();if(n.value.length>0){if(h.silent)return!1;throw new Ke(`Form validation failed: ${JSON.stringify(n.value,null,2)}`)}return r.state}async function c(u){var d;const h=u;try{(d=r.validateOn)!=null&&d.includes("submit")&&await l();const f={...h,data:r.state};t("submit",f)}catch(f){if(!(f instanceof Ke))throw f;const p={...h,errors:n.value.map(g=>({...g,id:a.value[g.path]}))};t("error",p)}}return e({validate:l,errors:n,setErrors(u,h){h?n.value=n.value.filter(d=>d.path!==h).concat(u):n.value=u},async submit(){await c(new Event("submit"))},getErrors(u){return u?n.value.filter(h=>h.path===u):n.value},clear(u){u?n.value=n.value.filter(h=>h.path!==u):n.value=[]}}),{onSubmit:c}}});function pr(r){return r.validate&&r.__isYupSchema__}function gr(r){return r.inner!==void 0}async function mr(r,e){try{return await e.validate(r,{abortEarly:!1}),[]}catch(t){if(gr(t))return t.inner.map(s=>({path:s.path??"",message:s.message}));throw t}}function yr(r){return r.parse!==void 0}async function vr(r,e){const t=await e.safeParseAsync(r);return t.success===!1?t.error.issues.map(s=>({path:s.path.join("."),message:s.message})):[]}function _r(r){return r.validateAsync!==void 0&&r.id!==void 0}function br(r){return r.isJoi===!0}async function wr(r,e){try{return await e.validateAsync(r,{abortEarly:!1}),[]}catch(t){if(br(t))return t.details.map(s=>({path:s.path.join("."),message:s.message}));throw t}}function kr(r){return"_parse"in r||"_run"in r||typeof r=="function"&&"schema"in r}async function Sr(r,e){var s;return((s=(await("_parse"in e?e._parse(r):"_run"in e?e._run({typed:!1,value:r},{}):e(r))).issues)==null?void 0:s.map(i=>{var n;return{path:((n=i.path)==null?void 0:n.map(a=>a.key).join("."))||"",message:i.message}}))||[]}function $r(r,e,t,s,i,n){return A(),j("form",{onSubmit:e[0]||(e[0]=tr((...a)=>r.onSubmit&&r.onSubmit(...a),["prevent"]))},[B(r.$slots,"default")],32)}const xa=Et(fr,[["render",$r]]);function ae(r){this._maxSize=r,this.clear()}ae.prototype.clear=function(){this._size=0,this._values=Object.create(null)};ae.prototype.get=function(r){return this._values[r]};ae.prototype.set=function(r,e){return this._size>=this._maxSize&&this.clear(),r in this._values||this._size++,this._values[r]=e};var Er=/[^.^\]^[]+|(?=\[\]|\.\.)/g,gs=/^\d+$/,Or=/^\d/,Tr=/[~`!#$%\^&*+=\-\[\]\\';,/{}|\\":<>\?]/g,xr=/^\s*(['"]?)(.*?)(\1)\s*$/,Tt=512,Bt=new ae(Tt),Mt=new ae(Tt),qt=new ae(Tt),ne={Cache:ae,split:gt,normalizePath:ot,setter:function(r){var e=ot(r);return Mt.get(r)||Mt.set(r,function(s,i){for(var n=0,a=e.length,o=s;n<a-1;){var l=e[n];if(l==="__proto__"||l==="constructor"||l==="prototype")return s;o=o[e[n++]]}o[e[n]]=i})},getter:function(r,e){var t=ot(r);return qt.get(r)||qt.set(r,function(i){for(var n=0,a=t.length;n<a;)if(i!=null||!e)i=i[t[n++]];else return;return i})},join:function(r){return r.reduce(function(e,t){return e+(xt(t)||gs.test(t)?"["+t+"]":(e?".":"")+t)},"")},forEach:function(r,e,t){Ar(Array.isArray(r)?r:gt(r),e,t)}};function ot(r){return Bt.get(r)||Bt.set(r,gt(r).map(function(e){return e.replace(xr,"$2")}))}function gt(r){return r.match(Er)||[""]}function Ar(r,e,t){var s=r.length,i,n,a,o;for(n=0;n<s;n++)i=r[n],i&&(Pr(i)&&(i='"'+i+'"'),o=xt(i),a=!o&&/^\d+$/.test(i),e.call(t,i,o,a,n,r))}function xt(r){return typeof r=="string"&&r&&["'",'"'].indexOf(r.charAt(0))!==-1}function jr(r){return r.match(Or)&&!r.match(gs)}function Cr(r){return Tr.test(r)}function Pr(r){return!xt(r)&&(jr(r)||Cr(r))}const Ir=/[A-Z\xc0-\xd6\xd8-\xde]?[a-z\xdf-\xf6\xf8-\xff]+(?:['’](?:d|ll|m|re|s|t|ve))?(?=[\xac\xb1\xd7\xf7\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\xbf\u2000-\u206f \t\x0b\f\xa0\ufeff\n\r\u2028\u2029\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000]|[A-Z\xc0-\xd6\xd8-\xde]|$)|(?:[A-Z\xc0-\xd6\xd8-\xde]|[^\ud800-\udfff\xac\xb1\xd7\xf7\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\xbf\u2000-\u206f \t\x0b\f\xa0\ufeff\n\r\u2028\u2029\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\d+\u2700-\u27bfa-z\xdf-\xf6\xf8-\xffA-Z\xc0-\xd6\xd8-\xde])+(?:['’](?:D|LL|M|RE|S|T|VE))?(?=[\xac\xb1\xd7\xf7\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\xbf\u2000-\u206f \t\x0b\f\xa0\ufeff\n\r\u2028\u2029\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000]|[A-Z\xc0-\xd6\xd8-\xde](?:[a-z\xdf-\xf6\xf8-\xff]|[^\ud800-\udfff\xac\xb1\xd7\xf7\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\xbf\u2000-\u206f \t\x0b\f\xa0\ufeff\n\r\u2028\u2029\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\d+\u2700-\u27bfa-z\xdf-\xf6\xf8-\xffA-Z\xc0-\xd6\xd8-\xde])|$)|[A-Z\xc0-\xd6\xd8-\xde]?(?:[a-z\xdf-\xf6\xf8-\xff]|[^\ud800-\udfff\xac\xb1\xd7\xf7\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\xbf\u2000-\u206f \t\x0b\f\xa0\ufeff\n\r\u2028\u2029\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\d+\u2700-\u27bfa-z\xdf-\xf6\xf8-\xffA-Z\xc0-\xd6\xd8-\xde])+(?:['’](?:d|ll|m|re|s|t|ve))?|[A-Z\xc0-\xd6\xd8-\xde]+(?:['’](?:D|LL|M|RE|S|T|VE))?|\d*(?:1ST|2ND|3RD|(?![123])\dTH)(?=\b|[a-z_])|\d*(?:1st|2nd|3rd|(?![123])\dth)(?=\b|[A-Z_])|\d+|(?:[\u2700-\u27bf]|(?:\ud83c[\udde6-\uddff]){2}|[\ud800-\udbff][\udc00-\udfff])[\ufe0e\ufe0f]?(?:[\u0300-\u036f\ufe20-\ufe2f\u20d0-\u20ff]|\ud83c[\udffb-\udfff])?(?:\u200d(?:[^\ud800-\udfff]|(?:\ud83c[\udde6-\uddff]){2}|[\ud800-\udbff][\udc00-\udfff])[\ufe0e\ufe0f]?(?:[\u0300-\u036f\ufe20-\ufe2f\u20d0-\u20ff]|\ud83c[\udffb-\udfff])?)*/g,Ze=r=>r.match(Ir)||[],Ye=r=>r[0].toUpperCase()+r.slice(1),At=(r,e)=>Ze(r).join(e).toLowerCase(),ms=r=>Ze(r).reduce((e,t)=>`${e}${e?t[0].toUpperCase()+t.slice(1).toLowerCase():t.toLowerCase()}`,""),Rr=r=>Ye(ms(r)),Fr=r=>At(r,"_"),Dr=r=>At(r,"-"),Lr=r=>Ye(At(r," ")),Ur=r=>Ze(r).map(Ye).join(" ");var lt={words:Ze,upperFirst:Ye,camelCase:ms,pascalCase:Rr,snakeCase:Fr,kebabCase:Dr,sentenceCase:Lr,titleCase:Ur},jt={exports:{}};jt.exports=function(r){return ys(Nr(r),r)};jt.exports.array=ys;function ys(r,e){var t=r.length,s=new Array(t),i={},n=t,a=zr(e),o=Br(r);for(e.forEach(function(c){if(!o.has(c[0])||!o.has(c[1]))throw new Error("Unknown node. There is an unknown node in the supplied edges.")});n--;)i[n]||l(r[n],n,new Set);return s;function l(c,u,h){if(h.has(c)){var d;try{d=", node was:"+JSON.stringify(c)}catch{d=""}throw new Error("Cyclic dependency"+d)}if(!o.has(c))throw new Error("Found unknown node. Make sure to provided all involved nodes. Unknown node: "+JSON.stringify(c));if(!i[u]){i[u]=!0;var f=a.get(c)||new Set;if(f=Array.from(f),u=f.length){h.add(c);do{var p=f[--u];l(p,o.get(p),h)}while(u);h.delete(c)}s[--t]=c}}}function Nr(r){for(var e=new Set,t=0,s=r.length;t<s;t++){var i=r[t];e.add(i[0]),e.add(i[1])}return Array.from(e)}function zr(r){for(var e=new Map,t=0,s=r.length;t<s;t++){var i=r[t];e.has(i[0])||e.set(i[0],new Set),e.has(i[1])||e.set(i[1],new Set),e.get(i[0]).add(i[1])}return e}function Br(r){for(var e=new Map,t=0,s=r.length;t<s;t++)e.set(r[t],t);return e}var Mr=jt.exports;const qr=rr(Mr),Vr=Object.prototype.toString,Jr=Error.prototype.toString,Hr=RegExp.prototype.toString,Kr=typeof Symbol<"u"?Symbol.prototype.toString:()=>"",Gr=/^Symbol\((.*)\)(.*)$/;function Wr(r){return r!=+r?"NaN":r===0&&1/r<0?"-0":""+r}function Vt(r,e=!1){if(r==null||r===!0||r===!1)return""+r;const t=typeof r;if(t==="number")return Wr(r);if(t==="string")return e?`"${r}"`:r;if(t==="function")return"[Function "+(r.name||"anonymous")+"]";if(t==="symbol")return Kr.call(r).replace(Gr,"Symbol($1)");const s=Vr.call(r).slice(8,-1);return s==="Date"?isNaN(r.getTime())?""+r:r.toISOString(r):s==="Error"||r instanceof Error?"["+Jr.call(r)+"]":s==="RegExp"?Hr.call(r):null}function Y(r,e){let t=Vt(r,e);return t!==null?t:JSON.stringify(r,function(s,i){let n=Vt(this[s],e);return n!==null?n:i},2)}function vs(r){return r==null?[]:[].concat(r)}let _s,bs,ws,Zr=/\$\{\s*(\w+)\s*\}/g;_s=Symbol.toStringTag;class Jt{constructor(e,t,s,i){this.name=void 0,this.message=void 0,this.value=void 0,this.path=void 0,this.type=void 0,this.params=void 0,this.errors=void 0,this.inner=void 0,this[_s]="Error",this.name="ValidationError",this.value=t,this.path=s,this.type=i,this.errors=[],this.inner=[],vs(e).forEach(n=>{if(P.isError(n)){this.errors.push(...n.errors);const a=n.inner.length?n.inner:[n];this.inner.push(...a)}else this.errors.push(n)}),this.message=this.errors.length>1?`${this.errors.length} errors occurred`:this.errors[0]}}bs=Symbol.hasInstance;ws=Symbol.toStringTag;class P extends Error{static formatError(e,t){const s=t.label||t.path||"this";return s!==t.path&&(t=Object.assign({},t,{path:s})),typeof e=="string"?e.replace(Zr,(i,n)=>Y(t[n])):typeof e=="function"?e(t):e}static isError(e){return e&&e.name==="ValidationError"}constructor(e,t,s,i,n){const a=new Jt(e,t,s,i);if(n)return a;super(),this.value=void 0,this.path=void 0,this.type=void 0,this.params=void 0,this.errors=[],this.inner=[],this[ws]="Error",this.name=a.name,this.message=a.message,this.type=a.type,this.value=a.value,this.path=a.path,this.errors=a.errors,this.inner=a.inner,Error.captureStackTrace&&Error.captureStackTrace(this,P)}static[bs](e){return Jt[Symbol.hasInstance](e)||super[Symbol.hasInstance](e)}}let z={default:"${path} is invalid",required:"${path} is a required field",defined:"${path} must be defined",notNull:"${path} cannot be null",oneOf:"${path} must be one of the following values: ${values}",notOneOf:"${path} must not be one of the following values: ${values}",notType:({path:r,type:e,value:t,originalValue:s})=>{const i=s!=null&&s!==t?` (cast from the value \`${Y(s,!0)}\`).`:".";return e!=="mixed"?`${r} must be a \`${e}\` type, but the final value was: \`${Y(t,!0)}\``+i:`${r} must match the configured type. The validated value was: \`${Y(t,!0)}\``+i}},C={length:"${path} must be exactly ${length} characters",min:"${path} must be at least ${min} characters",max:"${path} must be at most ${max} characters",matches:'${path} must match the following: "${regex}"',email:"${path} must be a valid email",url:"${path} must be a valid URL",uuid:"${path} must be a valid UUID",datetime:"${path} must be a valid ISO date-time",datetime_precision:"${path} must be a valid ISO date-time with a sub-second precision of exactly ${precision} digits",datetime_offset:'${path} must be a valid ISO date-time with UTC "Z" timezone',trim:"${path} must be a trimmed string",lowercase:"${path} must be a lowercase string",uppercase:"${path} must be a upper case string"},Yr={min:"${path} must be greater than or equal to ${min}",max:"${path} must be less than or equal to ${max}",lessThan:"${path} must be less than ${less}",moreThan:"${path} must be greater than ${more}",positive:"${path} must be a positive number",negative:"${path} must be a negative number",integer:"${path} must be an integer"},mt={min:"${path} field must be later than ${min}",max:"${path} field must be at earlier than ${max}"},Qr={isValue:"${path} field must be ${value}"},yt={noUnknown:"${path} field has unspecified keys: ${unknown}"},Xr={min:"${path} field must have at least ${min} items",max:"${path} field must have less than or equal to ${max} items",length:"${path} must have ${length} items"},ei={notType:r=>{const{path:e,value:t,spec:s}=r,i=s.types.length;if(Array.isArray(t)){if(t.length<i)return`${e} tuple value has too few items, expected a length of ${i} but got ${t.length} for value: \`${Y(t,!0)}\``;if(t.length>i)return`${e} tuple value has too many items, expected a length of ${i} but got ${t.length} for value: \`${Y(t,!0)}\``}return P.formatError(z.notType,r)}};Object.assign(Object.create(null),{mixed:z,string:C,number:Yr,date:mt,object:yt,array:Xr,boolean:Qr,tuple:ei});const Ct=r=>r&&r.__isYupSchema__;class Ge{static fromOptions(e,t){if(!t.then&&!t.otherwise)throw new TypeError("either `then:` or `otherwise:` is required for `when()` conditions");let{is:s,then:i,otherwise:n}=t,a=typeof s=="function"?s:(...o)=>o.every(l=>l===s);return new Ge(e,(o,l)=>{var c;let u=a(...o)?i:n;return(c=u==null?void 0:u(l))!=null?c:l})}constructor(e,t){this.fn=void 0,this.refs=e,this.refs=e,this.fn=t}resolve(e,t){let s=this.refs.map(n=>n.getValue(t==null?void 0:t.value,t==null?void 0:t.parent,t==null?void 0:t.context)),i=this.fn(s,e,t);if(i===void 0||i===e)return e;if(!Ct(i))throw new TypeError("conditions must return a schema object");return i.resolve(t)}}const Ue={context:"$",value:"."};class oe{constructor(e,t={}){if(this.key=void 0,this.isContext=void 0,this.isValue=void 0,this.isSibling=void 0,this.path=void 0,this.getter=void 0,this.map=void 0,typeof e!="string")throw new TypeError("ref must be a string, got: "+e);if(this.key=e.trim(),e==="")throw new TypeError("ref must be a non-empty string");this.isContext=this.key[0]===Ue.context,this.isValue=this.key[0]===Ue.value,this.isSibling=!this.isContext&&!this.isValue;let s=this.isContext?Ue.context:this.isValue?Ue.value:"";this.path=this.key.slice(s.length),this.getter=this.path&&ne.getter(this.path,!0),this.map=t.map}getValue(e,t,s){let i=this.isContext?s:this.isValue?e:t;return this.getter&&(i=this.getter(i||{})),this.map&&(i=this.map(i)),i}cast(e,t){return this.getValue(e,t==null?void 0:t.parent,t==null?void 0:t.context)}resolve(){return this}describe(){return{type:"ref",key:this.key}}toString(){return`Ref(${this.key})`}static isRef(e){return e&&e.__isYupRef}}oe.prototype.__isYupRef=!0;const re=r=>r==null;function he(r){function e({value:t,path:s="",options:i,originalValue:n,schema:a},o,l){const{name:c,test:u,params:h,message:d,skipAbsent:f}=r;let{parent:p,context:g,abortEarly:m=a.spec.abortEarly,disableStackTrace:w=a.spec.disableStackTrace}=i;function S(k){return oe.isRef(k)?k.getValue(t,p,g):k}function x(k={}){const q=Object.assign({value:t,originalValue:n,label:a.spec.label,path:k.path||s,spec:a.spec,disableStackTrace:k.disableStackTrace||w},h,k.params);for(const b of Object.keys(q))q[b]=S(q[b]);const Le=new P(P.formatError(k.message||d,q),t,q.path,k.type||c,q.disableStackTrace);return Le.params=q,Le}const E=m?o:l;let O={path:s,parent:p,type:c,from:i.from,createError:x,resolve:S,options:i,originalValue:n,schema:a};const H=k=>{P.isError(k)?E(k):k?l(null):E(x())},Se=k=>{P.isError(k)?E(k):o(k)};if(f&&re(t))return H(!0);let ue;try{var De;if(ue=u.call(O,t,O),typeof((De=ue)==null?void 0:De.then)=="function"){if(i.sync)throw new Error(`Validation test of type: "${O.type}" returned a Promise during a synchronous validate. This test will finish after the validate call has returned`);return Promise.resolve(ue).then(H,Se)}}catch(k){Se(k);return}H(ue)}return e.OPTIONS=r,e}function ti(r,e,t,s=t){let i,n,a;return e?(ne.forEach(e,(o,l,c)=>{let u=l?o.slice(1,o.length-1):o;r=r.resolve({context:s,parent:i,value:t});let h=r.type==="tuple",d=c?parseInt(u,10):0;if(r.innerType||h){if(h&&!c)throw new Error(`Yup.reach cannot implicitly index into a tuple type. the path part "${a}" must contain an index to the tuple element, e.g. "${a}[0]"`);if(t&&d>=t.length)throw new Error(`Yup.reach cannot resolve an array item at index: ${o}, in the path: ${e}. because there is no value at that index. `);i=t,t=t&&t[d],r=h?r.spec.types[d]:r.innerType}if(!c){if(!r.fields||!r.fields[u])throw new Error(`The schema does not contain the path: ${e}. (failed at: ${a} which is a type: "${r.type}")`);i=t,t=t&&t[u],r=r.fields[u]}n=u,a=l?"["+o+"]":"."+o}),{schema:r,parent:i,parentPath:n}):{parent:i,parentPath:e,schema:r}}class We extends Set{describe(){const e=[];for(const t of this.values())e.push(oe.isRef(t)?t.describe():t);return e}resolveAll(e){let t=[];for(const s of this.values())t.push(e(s));return t}clone(){return new We(this.values())}merge(e,t){const s=this.clone();return e.forEach(i=>s.add(i)),t.forEach(i=>s.delete(i)),s}}function me(r,e=new Map){if(Ct(r)||!r||typeof r!="object")return r;if(e.has(r))return e.get(r);let t;if(r instanceof Date)t=new Date(r.getTime()),e.set(r,t);else if(r instanceof RegExp)t=new RegExp(r),e.set(r,t);else if(Array.isArray(r)){t=new Array(r.length),e.set(r,t);for(let s=0;s<r.length;s++)t[s]=me(r[s],e)}else if(r instanceof Map){t=new Map,e.set(r,t);for(const[s,i]of r.entries())t.set(s,me(i,e))}else if(r instanceof Set){t=new Set,e.set(r,t);for(const s of r)t.add(me(s,e))}else if(r instanceof Object){t={},e.set(r,t);for(const[s,i]of Object.entries(r))t[s]=me(i,e)}else throw Error(`Unable to clone ${r}`);return t}class M{constructor(e){this.type=void 0,this.deps=[],this.tests=void 0,this.transforms=void 0,this.conditions=[],this._mutate=void 0,this.internalTests={},this._whitelist=new We,this._blacklist=new We,this.exclusiveTests=Object.create(null),this._typeCheck=void 0,this.spec=void 0,this.tests=[],this.transforms=[],this.withMutation(()=>{this.typeError(z.notType)}),this.type=e.type,this._typeCheck=e.check,this.spec=Object.assign({strip:!1,strict:!1,abortEarly:!0,recursive:!0,disableStackTrace:!1,nullable:!1,optional:!0,coerce:!0},e==null?void 0:e.spec),this.withMutation(t=>{t.nonNullable()})}get _type(){return this.type}clone(e){if(this._mutate)return e&&Object.assign(this.spec,e),this;const t=Object.create(Object.getPrototypeOf(this));return t.type=this.type,t._typeCheck=this._typeCheck,t._whitelist=this._whitelist.clone(),t._blacklist=this._blacklist.clone(),t.internalTests=Object.assign({},this.internalTests),t.exclusiveTests=Object.assign({},this.exclusiveTests),t.deps=[...this.deps],t.conditions=[...this.conditions],t.tests=[...this.tests],t.transforms=[...this.transforms],t.spec=me(Object.assign({},this.spec,e)),t}label(e){let t=this.clone();return t.spec.label=e,t}meta(...e){if(e.length===0)return this.spec.meta;let t=this.clone();return t.spec.meta=Object.assign(t.spec.meta||{},e[0]),t}withMutation(e){let t=this._mutate;this._mutate=!0;let s=e(this);return this._mutate=t,s}concat(e){if(!e||e===this)return this;if(e.type!==this.type&&this.type!=="mixed")throw new TypeError(`You cannot \`concat()\` schema's of different types: ${this.type} and ${e.type}`);let t=this,s=e.clone();const i=Object.assign({},t.spec,s.spec);return s.spec=i,s.internalTests=Object.assign({},t.internalTests,s.internalTests),s._whitelist=t._whitelist.merge(e._whitelist,e._blacklist),s._blacklist=t._blacklist.merge(e._blacklist,e._whitelist),s.tests=t.tests,s.exclusiveTests=t.exclusiveTests,s.withMutation(n=>{e.tests.forEach(a=>{n.test(a.OPTIONS)})}),s.transforms=[...t.transforms,...s.transforms],s}isType(e){return e==null?!!(this.spec.nullable&&e===null||this.spec.optional&&e===void 0):this._typeCheck(e)}resolve(e){let t=this;if(t.conditions.length){let s=t.conditions;t=t.clone(),t.conditions=[],t=s.reduce((i,n)=>n.resolve(i,e),t),t=t.resolve(e)}return t}resolveOptions(e){var t,s,i,n;return Object.assign({},e,{from:e.from||[],strict:(t=e.strict)!=null?t:this.spec.strict,abortEarly:(s=e.abortEarly)!=null?s:this.spec.abortEarly,recursive:(i=e.recursive)!=null?i:this.spec.recursive,disableStackTrace:(n=e.disableStackTrace)!=null?n:this.spec.disableStackTrace})}cast(e,t={}){let s=this.resolve(Object.assign({value:e},t)),i=t.assert==="ignore-optionality",n=s._cast(e,t);if(t.assert!==!1&&!s.isType(n)){if(i&&re(n))return n;let a=Y(e),o=Y(n);throw new TypeError(`The value of ${t.path||"field"} could not be cast to a value that satisfies the schema type: "${s.type}". 

attempted value: ${a} 
`+(o!==a?`result of cast: ${o}`:""))}return n}_cast(e,t){let s=e===void 0?e:this.transforms.reduce((i,n)=>n.call(this,i,e,this),e);return s===void 0&&(s=this.getDefault(t)),s}_validate(e,t={},s,i){let{path:n,originalValue:a=e,strict:o=this.spec.strict}=t,l=e;o||(l=this._cast(l,Object.assign({assert:!1},t)));let c=[];for(let u of Object.values(this.internalTests))u&&c.push(u);this.runTests({path:n,value:l,originalValue:a,options:t,tests:c},s,u=>{if(u.length)return i(u,l);this.runTests({path:n,value:l,originalValue:a,options:t,tests:this.tests},s,i)})}runTests(e,t,s){let i=!1,{tests:n,value:a,originalValue:o,path:l,options:c}=e,u=g=>{i||(i=!0,t(g,a))},h=g=>{i||(i=!0,s(g,a))},d=n.length,f=[];if(!d)return h([]);let p={value:a,originalValue:o,path:l,options:c,schema:this};for(let g=0;g<n.length;g++){const m=n[g];m(p,u,function(S){S&&(Array.isArray(S)?f.push(...S):f.push(S)),--d<=0&&h(f)})}}asNestedTest({key:e,index:t,parent:s,parentPath:i,originalParent:n,options:a}){const o=e??t;if(o==null)throw TypeError("Must include `key` or `index` for nested validations");const l=typeof o=="number";let c=s[o];const u=Object.assign({},a,{strict:!0,parent:s,value:c,originalValue:n[o],key:void 0,[l?"index":"key"]:o,path:l||o.includes(".")?`${i||""}[${l?o:`"${o}"`}]`:(i?`${i}.`:"")+e});return(h,d,f)=>this.resolve(u)._validate(c,u,d,f)}validate(e,t){var s;let i=this.resolve(Object.assign({},t,{value:e})),n=(s=t==null?void 0:t.disableStackTrace)!=null?s:i.spec.disableStackTrace;return new Promise((a,o)=>i._validate(e,t,(l,c)=>{P.isError(l)&&(l.value=c),o(l)},(l,c)=>{l.length?o(new P(l,c,void 0,void 0,n)):a(c)}))}validateSync(e,t){var s;let i=this.resolve(Object.assign({},t,{value:e})),n,a=(s=t==null?void 0:t.disableStackTrace)!=null?s:i.spec.disableStackTrace;return i._validate(e,Object.assign({},t,{sync:!0}),(o,l)=>{throw P.isError(o)&&(o.value=l),o},(o,l)=>{if(o.length)throw new P(o,e,void 0,void 0,a);n=l}),n}isValid(e,t){return this.validate(e,t).then(()=>!0,s=>{if(P.isError(s))return!1;throw s})}isValidSync(e,t){try{return this.validateSync(e,t),!0}catch(s){if(P.isError(s))return!1;throw s}}_getDefault(e){let t=this.spec.default;return t==null?t:typeof t=="function"?t.call(this,e):me(t)}getDefault(e){return this.resolve(e||{})._getDefault(e)}default(e){return arguments.length===0?this._getDefault():this.clone({default:e})}strict(e=!0){return this.clone({strict:e})}nullability(e,t){const s=this.clone({nullable:e});return s.internalTests.nullable=he({message:t,name:"nullable",test(i){return i===null?this.schema.spec.nullable:!0}}),s}optionality(e,t){const s=this.clone({optional:e});return s.internalTests.optionality=he({message:t,name:"optionality",test(i){return i===void 0?this.schema.spec.optional:!0}}),s}optional(){return this.optionality(!0)}defined(e=z.defined){return this.optionality(!1,e)}nullable(){return this.nullability(!0)}nonNullable(e=z.notNull){return this.nullability(!1,e)}required(e=z.required){return this.clone().withMutation(t=>t.nonNullable(e).defined(e))}notRequired(){return this.clone().withMutation(e=>e.nullable().optional())}transform(e){let t=this.clone();return t.transforms.push(e),t}test(...e){let t;if(e.length===1?typeof e[0]=="function"?t={test:e[0]}:t=e[0]:e.length===2?t={name:e[0],test:e[1]}:t={name:e[0],message:e[1],test:e[2]},t.message===void 0&&(t.message=z.default),typeof t.test!="function")throw new TypeError("`test` is a required parameters");let s=this.clone(),i=he(t),n=t.exclusive||t.name&&s.exclusiveTests[t.name]===!0;if(t.exclusive&&!t.name)throw new TypeError("Exclusive tests must provide a unique `name` identifying the test");return t.name&&(s.exclusiveTests[t.name]=!!t.exclusive),s.tests=s.tests.filter(a=>!(a.OPTIONS.name===t.name&&(n||a.OPTIONS.test===i.OPTIONS.test))),s.tests.push(i),s}when(e,t){!Array.isArray(e)&&typeof e!="string"&&(t=e,e=".");let s=this.clone(),i=vs(e).map(n=>new oe(n));return i.forEach(n=>{n.isSibling&&s.deps.push(n.key)}),s.conditions.push(typeof t=="function"?new Ge(i,t):Ge.fromOptions(i,t)),s}typeError(e){let t=this.clone();return t.internalTests.typeError=he({message:e,name:"typeError",skipAbsent:!0,test(s){return this.schema._typeCheck(s)?!0:this.createError({params:{type:this.schema.type}})}}),t}oneOf(e,t=z.oneOf){let s=this.clone();return e.forEach(i=>{s._whitelist.add(i),s._blacklist.delete(i)}),s.internalTests.whiteList=he({message:t,name:"oneOf",skipAbsent:!0,test(i){let n=this.schema._whitelist,a=n.resolveAll(this.resolve);return a.includes(i)?!0:this.createError({params:{values:Array.from(n).join(", "),resolved:a}})}}),s}notOneOf(e,t=z.notOneOf){let s=this.clone();return e.forEach(i=>{s._blacklist.add(i),s._whitelist.delete(i)}),s.internalTests.blacklist=he({message:t,name:"notOneOf",test(i){let n=this.schema._blacklist,a=n.resolveAll(this.resolve);return a.includes(i)?this.createError({params:{values:Array.from(n).join(", "),resolved:a}}):!0}}),s}strip(e=!0){let t=this.clone();return t.spec.strip=e,t}describe(e){const t=(e?this.resolve(e):this).clone(),{label:s,meta:i,optional:n,nullable:a}=t.spec;return{meta:i,label:s,optional:n,nullable:a,default:t.getDefault(e),type:t.type,oneOf:t._whitelist.describe(),notOneOf:t._blacklist.describe(),tests:t.tests.map(l=>({name:l.OPTIONS.name,params:l.OPTIONS.params})).filter((l,c,u)=>u.findIndex(h=>h.name===l.name)===c)}}}M.prototype.__isYupSchema__=!0;for(const r of["validate","validateSync"])M.prototype[`${r}At`]=function(e,t,s={}){const{parent:i,parentPath:n,schema:a}=ti(this,e,t,s.context);return a[r](i&&i[n],Object.assign({},s,{parent:i,path:e}))};for(const r of["equals","is"])M.prototype[r]=M.prototype.oneOf;for(const r of["not","nope"])M.prototype[r]=M.prototype.notOneOf;const si=/^(\d{4}|[+-]\d{6})(?:-?(\d{2})(?:-?(\d{2}))?)?(?:[ T]?(\d{2}):?(\d{2})(?::?(\d{2})(?:[,.](\d{1,}))?)?(?:(Z)|([+-])(\d{2})(?::?(\d{2}))?)?)?$/;function ri(r){const e=vt(r);if(!e)return Date.parse?Date.parse(r):Number.NaN;if(e.z===void 0&&e.plusMinus===void 0)return new Date(e.year,e.month,e.day,e.hour,e.minute,e.second,e.millisecond).valueOf();let t=0;return e.z!=="Z"&&e.plusMinus!==void 0&&(t=e.hourOffset*60+e.minuteOffset,e.plusMinus==="+"&&(t=0-t)),Date.UTC(e.year,e.month,e.day,e.hour,e.minute+t,e.second,e.millisecond)}function vt(r){var e,t;const s=si.exec(r);return s?{year:J(s[1]),month:J(s[2],1)-1,day:J(s[3],1),hour:J(s[4]),minute:J(s[5]),second:J(s[6]),millisecond:s[7]?J(s[7].substring(0,3)):0,precision:(e=(t=s[7])==null?void 0:t.length)!=null?e:void 0,z:s[8]||void 0,plusMinus:s[9]||void 0,hourOffset:J(s[10]),minuteOffset:J(s[11])}:null}function J(r,e=0){return Number(r)||e}let ii=/^[a-zA-Z0-9.!#$%&'*+\/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/,ni=/^((https?|ftp):)?\/\/(((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:)*@)?(((\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5]))|((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?)(:\d*)?)(\/((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)+(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)*)*)?)?(\?((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|[\uE000-\uF8FF]|\/|\?)*)?(\#((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|\/|\?)*)?$/i,ai=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i,oi="^\\d{4}-\\d{2}-\\d{2}",li="\\d{2}:\\d{2}:\\d{2}",ui="(([+-]\\d{2}(:?\\d{2})?)|Z)",ci=new RegExp(`${oi}T${li}(\\.\\d+)?${ui}$`),hi=r=>re(r)||r===r.trim(),di={}.toString();function fi(){return new ks}class ks extends M{constructor(){super({type:"string",check(e){return e instanceof String&&(e=e.valueOf()),typeof e=="string"}}),this.withMutation(()=>{this.transform((e,t,s)=>{if(!s.spec.coerce||s.isType(e)||Array.isArray(e))return e;const i=e!=null&&e.toString?e.toString():e;return i===di?e:i})})}required(e){return super.required(e).withMutation(t=>t.test({message:e||z.required,name:"required",skipAbsent:!0,test:s=>!!s.length}))}notRequired(){return super.notRequired().withMutation(e=>(e.tests=e.tests.filter(t=>t.OPTIONS.name!=="required"),e))}length(e,t=C.length){return this.test({message:t,name:"length",exclusive:!0,params:{length:e},skipAbsent:!0,test(s){return s.length===this.resolve(e)}})}min(e,t=C.min){return this.test({message:t,name:"min",exclusive:!0,params:{min:e},skipAbsent:!0,test(s){return s.length>=this.resolve(e)}})}max(e,t=C.max){return this.test({name:"max",exclusive:!0,message:t,params:{max:e},skipAbsent:!0,test(s){return s.length<=this.resolve(e)}})}matches(e,t){let s=!1,i,n;return t&&(typeof t=="object"?{excludeEmptyString:s=!1,message:i,name:n}=t:i=t),this.test({name:n||"matches",message:i||C.matches,params:{regex:e},skipAbsent:!0,test:a=>a===""&&s||a.search(e)!==-1})}email(e=C.email){return this.matches(ii,{name:"email",message:e,excludeEmptyString:!0})}url(e=C.url){return this.matches(ni,{name:"url",message:e,excludeEmptyString:!0})}uuid(e=C.uuid){return this.matches(ai,{name:"uuid",message:e,excludeEmptyString:!1})}datetime(e){let t="",s,i;return e&&(typeof e=="object"?{message:t="",allowOffset:s=!1,precision:i=void 0}=e:t=e),this.matches(ci,{name:"datetime",message:t||C.datetime,excludeEmptyString:!0}).test({name:"datetime_offset",message:t||C.datetime_offset,params:{allowOffset:s},skipAbsent:!0,test:n=>{if(!n||s)return!0;const a=vt(n);return a?!!a.z:!1}}).test({name:"datetime_precision",message:t||C.datetime_precision,params:{precision:i},skipAbsent:!0,test:n=>{if(!n||i==null)return!0;const a=vt(n);return a?a.precision===i:!1}})}ensure(){return this.default("").transform(e=>e===null?"":e)}trim(e=C.trim){return this.transform(t=>t!=null?t.trim():t).test({message:e,name:"trim",test:hi})}lowercase(e=C.lowercase){return this.transform(t=>re(t)?t:t.toLowerCase()).test({message:e,name:"string_case",exclusive:!0,skipAbsent:!0,test:t=>re(t)||t===t.toLowerCase()})}uppercase(e=C.uppercase){return this.transform(t=>re(t)?t:t.toUpperCase()).test({message:e,name:"string_case",exclusive:!0,skipAbsent:!0,test:t=>re(t)||t===t.toUpperCase()})}}fi.prototype=ks.prototype;let pi=new Date(""),gi=r=>Object.prototype.toString.call(r)==="[object Date]";class Qe extends M{constructor(){super({type:"date",check(e){return gi(e)&&!isNaN(e.getTime())}}),this.withMutation(()=>{this.transform((e,t,s)=>!s.spec.coerce||s.isType(e)||e===null?e:(e=ri(e),isNaN(e)?Qe.INVALID_DATE:new Date(e)))})}prepareParam(e,t){let s;if(oe.isRef(e))s=e;else{let i=this.cast(e);if(!this._typeCheck(i))throw new TypeError(`\`${t}\` must be a Date or a value that can be \`cast()\` to a Date`);s=i}return s}min(e,t=mt.min){let s=this.prepareParam(e,"min");return this.test({message:t,name:"min",exclusive:!0,params:{min:e},skipAbsent:!0,test(i){return i>=this.resolve(s)}})}max(e,t=mt.max){let s=this.prepareParam(e,"max");return this.test({message:t,name:"max",exclusive:!0,params:{max:e},skipAbsent:!0,test(i){return i<=this.resolve(s)}})}}Qe.INVALID_DATE=pi;Qe.prototype;function mi(r,e=[]){let t=[],s=new Set,i=new Set(e.map(([a,o])=>`${a}-${o}`));function n(a,o){let l=ne.split(a)[0];s.add(l),i.has(`${o}-${l}`)||t.push([o,l])}for(const a of Object.keys(r)){let o=r[a];s.add(a),oe.isRef(o)&&o.isSibling?n(o.path,a):Ct(o)&&"deps"in o&&o.deps.forEach(l=>n(l,a))}return qr.array(Array.from(s),t).reverse()}function Ht(r,e){let t=1/0;return r.some((s,i)=>{var n;if((n=e.path)!=null&&n.includes(s))return t=i,!0}),t}function Ss(r){return(e,t)=>Ht(r,e)-Ht(r,t)}const yi=(r,e,t)=>{if(typeof r!="string")return r;let s=r;try{s=JSON.parse(r)}catch{}return t.isType(s)?s:r};function Je(r){if("fields"in r){const e={};for(const[t,s]of Object.entries(r.fields))e[t]=Je(s);return r.setFields(e)}if(r.type==="array"){const e=r.optional();return e.innerType&&(e.innerType=Je(e.innerType)),e}return r.type==="tuple"?r.optional().clone({types:r.spec.types.map(Je)}):"optional"in r?r.optional():r}const vi=(r,e)=>{const t=[...ne.normalizePath(e)];if(t.length===1)return t[0]in r;let s=t.pop(),i=ne.getter(ne.join(t),!0)(r);return!!(i&&s in i)};let Kt=r=>Object.prototype.toString.call(r)==="[object Object]";function _i(r,e){let t=Object.keys(r.fields);return Object.keys(e).filter(s=>t.indexOf(s)===-1)}const bi=Ss([]);function wi(r){return new $s(r)}class $s extends M{constructor(e){super({type:"object",check(t){return Kt(t)||typeof t=="function"}}),this.fields=Object.create(null),this._sortErrors=bi,this._nodes=[],this._excludedEdges=[],this.withMutation(()=>{e&&this.shape(e)})}_cast(e,t={}){var s;let i=super._cast(e,t);if(i===void 0)return this.getDefault(t);if(!this._typeCheck(i))return i;let n=this.fields,a=(s=t.stripUnknown)!=null?s:this.spec.noUnknown,o=[].concat(this._nodes,Object.keys(i).filter(h=>!this._nodes.includes(h))),l={},c=Object.assign({},t,{parent:l,__validating:t.__validating||!1}),u=!1;for(const h of o){let d=n[h],f=h in i;if(d){let p,g=i[h];c.path=(t.path?`${t.path}.`:"")+h,d=d.resolve({value:g,context:t.context,parent:l});let m=d instanceof M?d.spec:void 0,w=m==null?void 0:m.strict;if(m!=null&&m.strip){u=u||h in i;continue}p=!t.__validating||!w?d.cast(i[h],c):i[h],p!==void 0&&(l[h]=p)}else f&&!a&&(l[h]=i[h]);(f!==h in l||l[h]!==i[h])&&(u=!0)}return u?l:i}_validate(e,t={},s,i){let{from:n=[],originalValue:a=e,recursive:o=this.spec.recursive}=t;t.from=[{schema:this,value:a},...n],t.__validating=!0,t.originalValue=a,super._validate(e,t,s,(l,c)=>{if(!o||!Kt(c)){i(l,c);return}a=a||c;let u=[];for(let h of this._nodes){let d=this.fields[h];!d||oe.isRef(d)||u.push(d.asNestedTest({options:t,key:h,parent:c,parentPath:t.path,originalParent:a}))}this.runTests({tests:u,value:c,originalValue:a,options:t},s,h=>{i(h.sort(this._sortErrors).concat(l),c)})})}clone(e){const t=super.clone(e);return t.fields=Object.assign({},this.fields),t._nodes=this._nodes,t._excludedEdges=this._excludedEdges,t._sortErrors=this._sortErrors,t}concat(e){let t=super.concat(e),s=t.fields;for(let[i,n]of Object.entries(this.fields)){const a=s[i];s[i]=a===void 0?n:a}return t.withMutation(i=>i.setFields(s,[...this._excludedEdges,...e._excludedEdges]))}_getDefault(e){if("default"in this.spec)return super._getDefault(e);if(!this._nodes.length)return;let t={};return this._nodes.forEach(s=>{var i;const n=this.fields[s];let a=e;(i=a)!=null&&i.value&&(a=Object.assign({},a,{parent:a.value,value:a.value[s]})),t[s]=n&&"getDefault"in n?n.getDefault(a):void 0}),t}setFields(e,t){let s=this.clone();return s.fields=e,s._nodes=mi(e,t),s._sortErrors=Ss(Object.keys(e)),t&&(s._excludedEdges=t),s}shape(e,t=[]){return this.clone().withMutation(s=>{let i=s._excludedEdges;return t.length&&(Array.isArray(t[0])||(t=[t]),i=[...s._excludedEdges,...t]),s.setFields(Object.assign(s.fields,e),i)})}partial(){const e={};for(const[t,s]of Object.entries(this.fields))e[t]="optional"in s&&s.optional instanceof Function?s.optional():s;return this.setFields(e)}deepPartial(){return Je(this)}pick(e){const t={};for(const s of e)this.fields[s]&&(t[s]=this.fields[s]);return this.setFields(t,this._excludedEdges.filter(([s,i])=>e.includes(s)&&e.includes(i)))}omit(e){const t=[];for(const s of Object.keys(this.fields))e.includes(s)||t.push(s);return this.pick(t)}from(e,t,s){let i=ne.getter(e,!0);return this.transform(n=>{if(!n)return n;let a=n;return vi(n,e)&&(a=Object.assign({},n),s||delete a[e],a[t]=i(n)),a})}json(){return this.transform(yi)}noUnknown(e=!0,t=yt.noUnknown){typeof e!="boolean"&&(t=e,e=!0);let s=this.test({name:"noUnknown",exclusive:!0,message:t,test(i){if(i==null)return!0;const n=_i(this.schema,i);return!e||n.length===0||this.createError({params:{unknown:n.join(", ")}})}});return s.spec.noUnknown=e,s}unknown(e=!0,t=yt.noUnknown){return this.noUnknown(!e,t)}transformKeys(e){return this.transform(t=>{if(!t)return t;const s={};for(const i of Object.keys(t))s[e(i)]=t[i];return s})}camelCase(){return this.transformKeys(lt.camelCase)}snakeCase(){return this.transformKeys(lt.snakeCase)}constantCase(){return this.transformKeys(e=>lt.snakeCase(e).toUpperCase())}describe(e){const t=(e?this.resolve(e):this).clone(),s=super.describe(e);s.fields={};for(const[n,a]of Object.entries(t.fields)){var i;let o=e;(i=o)!=null&&i.value&&(o=Object.assign({},o,{parent:o.value,value:o.value[n]})),s.fields[n]=a.describe(o)}return s}}wi.prototype=$s.prototype;const ki=r=>{let e;return r?e=r:typeof fetch>"u"?e=(...t)=>_e(async()=>{const{default:s}=await Promise.resolve().then(()=>we);return{default:s}},void 0,import.meta.url).then(({default:s})=>s(...t)):e=fetch,(...t)=>e(...t)};class Pt extends Error{constructor(e,t="FunctionsError",s){super(e),this.name=t,this.context=s}}class Si extends Pt{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class $i extends Pt{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class Ei extends Pt{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var _t;(function(r){r.Any="any",r.ApNortheast1="ap-northeast-1",r.ApNortheast2="ap-northeast-2",r.ApSouth1="ap-south-1",r.ApSoutheast1="ap-southeast-1",r.ApSoutheast2="ap-southeast-2",r.CaCentral1="ca-central-1",r.EuCentral1="eu-central-1",r.EuWest1="eu-west-1",r.EuWest2="eu-west-2",r.EuWest3="eu-west-3",r.SaEast1="sa-east-1",r.UsEast1="us-east-1",r.UsWest1="us-west-1",r.UsWest2="us-west-2"})(_t||(_t={}));var Oi=function(r,e,t,s){function i(n){return n instanceof t?n:new t(function(a){a(n)})}return new(t||(t=Promise))(function(n,a){function o(u){try{c(s.next(u))}catch(h){a(h)}}function l(u){try{c(s.throw(u))}catch(h){a(h)}}function c(u){u.done?n(u.value):i(u.value).then(o,l)}c((s=s.apply(r,e||[])).next())})};class Ti{constructor(e,{headers:t={},customFetch:s,region:i=_t.Any}={}){this.url=e,this.headers=t,this.region=i,this.fetch=ki(s)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e,t={}){var s;return Oi(this,void 0,void 0,function*(){try{const{headers:i,method:n,body:a}=t;let o={},{region:l}=t;l||(l=this.region),l&&l!=="any"&&(o["x-region"]=l);let c;a&&(i&&!Object.prototype.hasOwnProperty.call(i,"Content-Type")||!i)&&(typeof Blob<"u"&&a instanceof Blob||a instanceof ArrayBuffer?(o["Content-Type"]="application/octet-stream",c=a):typeof a=="string"?(o["Content-Type"]="text/plain",c=a):typeof FormData<"u"&&a instanceof FormData?c=a:(o["Content-Type"]="application/json",c=JSON.stringify(a)));const u=yield this.fetch(`${this.url}/${e}`,{method:n||"POST",headers:Object.assign(Object.assign(Object.assign({},o),this.headers),i),body:c}).catch(p=>{throw new Si(p)}),h=u.headers.get("x-relay-error");if(h&&h==="true")throw new $i(u);if(!u.ok)throw new Ei(u);let d=((s=u.headers.get("Content-Type"))!==null&&s!==void 0?s:"text/plain").split(";")[0].trim(),f;return d==="application/json"?f=yield u.json():d==="application/octet-stream"?f=yield u.blob():d==="text/event-stream"?f=u:d==="multipart/form-data"?f=yield u.formData():f=yield u.text(),{data:f,error:null}}catch(i){return{data:null,error:i}}})}}var D={},It={},Xe={},Re={},et={},tt={},xi=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},be=xi();const Ai=be.fetch,Es=be.fetch.bind(be),Os=be.Headers,ji=be.Request,Ci=be.Response,we=Object.freeze(Object.defineProperty({__proto__:null,Headers:Os,Request:ji,Response:Ci,default:Es,fetch:Ai},Symbol.toStringTag,{value:"Module"})),Pi=ir(we);var Rt={};Object.defineProperty(Rt,"__esModule",{value:!0});class Ii extends Error{constructor(e){super(e.message),this.name="PostgrestError",this.details=e.details,this.hint=e.hint,this.code=e.code}}Rt.default=Ii;var Ts=L&&L.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(tt,"__esModule",{value:!0});const Ri=Ts(Pi),Fi=Ts(Rt);let Di=class{constructor(e){this.shouldThrowOnError=!1,this.method=e.method,this.url=e.url,this.headers=e.headers,this.schema=e.schema,this.body=e.body,this.shouldThrowOnError=e.shouldThrowOnError,this.signal=e.signal,this.isMaybeSingle=e.isMaybeSingle,e.fetch?this.fetch=e.fetch:typeof fetch>"u"?this.fetch=Ri.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}then(e,t){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),this.method!=="GET"&&this.method!=="HEAD"&&(this.headers["Content-Type"]="application/json");const s=this.fetch;let i=s(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async n=>{var a,o,l;let c=null,u=null,h=null,d=n.status,f=n.statusText;if(n.ok){if(this.method!=="HEAD"){const w=await n.text();w===""||(this.headers.Accept==="text/csv"||this.headers.Accept&&this.headers.Accept.includes("application/vnd.pgrst.plan+text")?u=w:u=JSON.parse(w))}const g=(a=this.headers.Prefer)===null||a===void 0?void 0:a.match(/count=(exact|planned|estimated)/),m=(o=n.headers.get("content-range"))===null||o===void 0?void 0:o.split("/");g&&m&&m.length>1&&(h=parseInt(m[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(u)&&(u.length>1?(c={code:"PGRST116",details:`Results contain ${u.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},u=null,h=null,d=406,f="Not Acceptable"):u.length===1?u=u[0]:u=null)}else{const g=await n.text();try{c=JSON.parse(g),Array.isArray(c)&&n.status===404&&(u=[],c=null,d=200,f="OK")}catch{n.status===404&&g===""?(d=204,f="No Content"):c={message:g}}if(c&&this.isMaybeSingle&&(!((l=c==null?void 0:c.details)===null||l===void 0)&&l.includes("0 rows"))&&(c=null,d=200,f="OK"),c&&this.shouldThrowOnError)throw new Fi.default(c)}return{error:c,data:u,count:h,status:d,statusText:f}});return this.shouldThrowOnError||(i=i.catch(n=>{var a,o,l;return{error:{message:`${(a=n==null?void 0:n.name)!==null&&a!==void 0?a:"FetchError"}: ${n==null?void 0:n.message}`,details:`${(o=n==null?void 0:n.stack)!==null&&o!==void 0?o:""}`,hint:"",code:`${(l=n==null?void 0:n.code)!==null&&l!==void 0?l:""}`},data:null,count:null,status:0,statusText:""}})),i.then(e,t)}};tt.default=Di;var Li=L&&L.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(et,"__esModule",{value:!0});const Ui=Li(tt);let Ni=class extends Ui.default{select(e){let t=!1;const s=(e??"*").split("").map(i=>/\s/.test(i)&&!t?"":(i==='"'&&(t=!t),i)).join("");return this.url.searchParams.set("select",s),this.headers.Prefer&&(this.headers.Prefer+=","),this.headers.Prefer+="return=representation",this}order(e,{ascending:t=!0,nullsFirst:s,foreignTable:i,referencedTable:n=i}={}){const a=n?`${n}.order`:"order",o=this.url.searchParams.get(a);return this.url.searchParams.set(a,`${o?`${o},`:""}${e}.${t?"asc":"desc"}${s===void 0?"":s?".nullsfirst":".nullslast"}`),this}limit(e,{foreignTable:t,referencedTable:s=t}={}){const i=typeof s>"u"?"limit":`${s}.limit`;return this.url.searchParams.set(i,`${e}`),this}range(e,t,{foreignTable:s,referencedTable:i=s}={}){const n=typeof i>"u"?"offset":`${i}.offset`,a=typeof i>"u"?"limit":`${i}.limit`;return this.url.searchParams.set(n,`${e}`),this.url.searchParams.set(a,`${t-e+1}`),this}abortSignal(e){return this.signal=e,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){return this.method==="GET"?this.headers.Accept="application/json":this.headers.Accept="application/vnd.pgrst.object+json",this.isMaybeSingle=!0,this}csv(){return this.headers.Accept="text/csv",this}geojson(){return this.headers.Accept="application/geo+json",this}explain({analyze:e=!1,verbose:t=!1,settings:s=!1,buffers:i=!1,wal:n=!1,format:a="text"}={}){var o;const l=[e?"analyze":null,t?"verbose":null,s?"settings":null,i?"buffers":null,n?"wal":null].filter(Boolean).join("|"),c=(o=this.headers.Accept)!==null&&o!==void 0?o:"application/json";return this.headers.Accept=`application/vnd.pgrst.plan+${a}; for="${c}"; options=${l};`,a==="json"?this:this}rollback(){var e;return((e=this.headers.Prefer)!==null&&e!==void 0?e:"").trim().length>0?this.headers.Prefer+=",tx=rollback":this.headers.Prefer="tx=rollback",this}returns(){return this}};et.default=Ni;var zi=L&&L.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(Re,"__esModule",{value:!0});const Bi=zi(et);let Mi=class extends Bi.default{eq(e,t){return this.url.searchParams.append(e,`eq.${t}`),this}neq(e,t){return this.url.searchParams.append(e,`neq.${t}`),this}gt(e,t){return this.url.searchParams.append(e,`gt.${t}`),this}gte(e,t){return this.url.searchParams.append(e,`gte.${t}`),this}lt(e,t){return this.url.searchParams.append(e,`lt.${t}`),this}lte(e,t){return this.url.searchParams.append(e,`lte.${t}`),this}like(e,t){return this.url.searchParams.append(e,`like.${t}`),this}likeAllOf(e,t){return this.url.searchParams.append(e,`like(all).{${t.join(",")}}`),this}likeAnyOf(e,t){return this.url.searchParams.append(e,`like(any).{${t.join(",")}}`),this}ilike(e,t){return this.url.searchParams.append(e,`ilike.${t}`),this}ilikeAllOf(e,t){return this.url.searchParams.append(e,`ilike(all).{${t.join(",")}}`),this}ilikeAnyOf(e,t){return this.url.searchParams.append(e,`ilike(any).{${t.join(",")}}`),this}is(e,t){return this.url.searchParams.append(e,`is.${t}`),this}in(e,t){const s=Array.from(new Set(t)).map(i=>typeof i=="string"&&new RegExp("[,()]").test(i)?`"${i}"`:`${i}`).join(",");return this.url.searchParams.append(e,`in.(${s})`),this}contains(e,t){return typeof t=="string"?this.url.searchParams.append(e,`cs.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cs.{${t.join(",")}}`):this.url.searchParams.append(e,`cs.${JSON.stringify(t)}`),this}containedBy(e,t){return typeof t=="string"?this.url.searchParams.append(e,`cd.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cd.{${t.join(",")}}`):this.url.searchParams.append(e,`cd.${JSON.stringify(t)}`),this}rangeGt(e,t){return this.url.searchParams.append(e,`sr.${t}`),this}rangeGte(e,t){return this.url.searchParams.append(e,`nxl.${t}`),this}rangeLt(e,t){return this.url.searchParams.append(e,`sl.${t}`),this}rangeLte(e,t){return this.url.searchParams.append(e,`nxr.${t}`),this}rangeAdjacent(e,t){return this.url.searchParams.append(e,`adj.${t}`),this}overlaps(e,t){return typeof t=="string"?this.url.searchParams.append(e,`ov.${t}`):this.url.searchParams.append(e,`ov.{${t.join(",")}}`),this}textSearch(e,t,{config:s,type:i}={}){let n="";i==="plain"?n="pl":i==="phrase"?n="ph":i==="websearch"&&(n="w");const a=s===void 0?"":`(${s})`;return this.url.searchParams.append(e,`${n}fts${a}.${t}`),this}match(e){return Object.entries(e).forEach(([t,s])=>{this.url.searchParams.append(t,`eq.${s}`)}),this}not(e,t,s){return this.url.searchParams.append(e,`not.${t}.${s}`),this}or(e,{foreignTable:t,referencedTable:s=t}={}){const i=s?`${s}.or`:"or";return this.url.searchParams.append(i,`(${e})`),this}filter(e,t,s){return this.url.searchParams.append(e,`${t}.${s}`),this}};Re.default=Mi;var qi=L&&L.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(Xe,"__esModule",{value:!0});const xe=qi(Re);let Vi=class{constructor(e,{headers:t={},schema:s,fetch:i}){this.url=e,this.headers=t,this.schema=s,this.fetch=i}select(e,{head:t=!1,count:s}={}){const i=t?"HEAD":"GET";let n=!1;const a=(e??"*").split("").map(o=>/\s/.test(o)&&!n?"":(o==='"'&&(n=!n),o)).join("");return this.url.searchParams.set("select",a),s&&(this.headers.Prefer=`count=${s}`),new xe.default({method:i,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}insert(e,{count:t,defaultToNull:s=!0}={}){const i="POST",n=[];if(this.headers.Prefer&&n.push(this.headers.Prefer),t&&n.push(`count=${t}`),s||n.push("missing=default"),this.headers.Prefer=n.join(","),Array.isArray(e)){const a=e.reduce((o,l)=>o.concat(Object.keys(l)),[]);if(a.length>0){const o=[...new Set(a)].map(l=>`"${l}"`);this.url.searchParams.set("columns",o.join(","))}}return new xe.default({method:i,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}upsert(e,{onConflict:t,ignoreDuplicates:s=!1,count:i,defaultToNull:n=!0}={}){const a="POST",o=[`resolution=${s?"ignore":"merge"}-duplicates`];if(t!==void 0&&this.url.searchParams.set("on_conflict",t),this.headers.Prefer&&o.push(this.headers.Prefer),i&&o.push(`count=${i}`),n||o.push("missing=default"),this.headers.Prefer=o.join(","),Array.isArray(e)){const l=e.reduce((c,u)=>c.concat(Object.keys(u)),[]);if(l.length>0){const c=[...new Set(l)].map(u=>`"${u}"`);this.url.searchParams.set("columns",c.join(","))}}return new xe.default({method:a,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}update(e,{count:t}={}){const s="PATCH",i=[];return this.headers.Prefer&&i.push(this.headers.Prefer),t&&i.push(`count=${t}`),this.headers.Prefer=i.join(","),new xe.default({method:s,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}delete({count:e}={}){const t="DELETE",s=[];return e&&s.push(`count=${e}`),this.headers.Prefer&&s.unshift(this.headers.Prefer),this.headers.Prefer=s.join(","),new xe.default({method:t,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}};Xe.default=Vi;var st={},rt={};Object.defineProperty(rt,"__esModule",{value:!0});rt.version=void 0;rt.version="0.0.0-automated";Object.defineProperty(st,"__esModule",{value:!0});st.DEFAULT_HEADERS=void 0;const Ji=rt;st.DEFAULT_HEADERS={"X-Client-Info":`postgrest-js/${Ji.version}`};var xs=L&&L.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(It,"__esModule",{value:!0});const Hi=xs(Xe),Ki=xs(Re),Gi=st;let Wi=class As{constructor(e,{headers:t={},schema:s,fetch:i}={}){this.url=e,this.headers=Object.assign(Object.assign({},Gi.DEFAULT_HEADERS),t),this.schemaName=s,this.fetch=i}from(e){const t=new URL(`${this.url}/${e}`);return new Hi.default(t,{headers:Object.assign({},this.headers),schema:this.schemaName,fetch:this.fetch})}schema(e){return new As(this.url,{headers:this.headers,schema:e,fetch:this.fetch})}rpc(e,t={},{head:s=!1,get:i=!1,count:n}={}){let a;const o=new URL(`${this.url}/rpc/${e}`);let l;s||i?(a=s?"HEAD":"GET",Object.entries(t).filter(([u,h])=>h!==void 0).map(([u,h])=>[u,Array.isArray(h)?`{${h.join(",")}}`:`${h}`]).forEach(([u,h])=>{o.searchParams.append(u,h)})):(a="POST",l=t);const c=Object.assign({},this.headers);return n&&(c.Prefer=`count=${n}`),new Ki.default({method:a,url:o,headers:c,schema:this.schemaName,body:l,fetch:this.fetch,allowEmpty:!1})}};It.default=Wi;var Fe=L&&L.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(D,"__esModule",{value:!0});D.PostgrestBuilder=D.PostgrestTransformBuilder=D.PostgrestFilterBuilder=D.PostgrestQueryBuilder=D.PostgrestClient=void 0;const js=Fe(It);D.PostgrestClient=js.default;const Cs=Fe(Xe);D.PostgrestQueryBuilder=Cs.default;const Ps=Fe(Re);D.PostgrestFilterBuilder=Ps.default;const Is=Fe(et);D.PostgrestTransformBuilder=Is.default;const Rs=Fe(tt);D.PostgrestBuilder=Rs.default;var Zi=D.default={PostgrestClient:js.default,PostgrestQueryBuilder:Cs.default,PostgrestFilterBuilder:Ps.default,PostgrestTransformBuilder:Is.default,PostgrestBuilder:Rs.default};const{PostgrestClient:Yi,PostgrestQueryBuilder:Ia,PostgrestFilterBuilder:Ra,PostgrestTransformBuilder:Fa,PostgrestBuilder:Da}=Zi,Qi="2.10.2",Xi={"X-Client-Info":`realtime-js/${Qi}`},en="1.0.0",Fs=1e4,tn=1e3;var ye;(function(r){r[r.connecting=0]="connecting",r[r.open=1]="open",r[r.closing=2]="closing",r[r.closed=3]="closed"})(ye||(ye={}));var I;(function(r){r.closed="closed",r.errored="errored",r.joined="joined",r.joining="joining",r.leaving="leaving"})(I||(I={}));var N;(function(r){r.close="phx_close",r.error="phx_error",r.join="phx_join",r.reply="phx_reply",r.leave="phx_leave",r.access_token="access_token"})(N||(N={}));var bt;(function(r){r.websocket="websocket"})(bt||(bt={}));var se;(function(r){r.Connecting="connecting",r.Open="open",r.Closing="closing",r.Closed="closed"})(se||(se={}));class sn{constructor(){this.HEADER_LENGTH=1}decode(e,t){return e.constructor===ArrayBuffer?t(this._binaryDecode(e)):t(typeof e=="string"?JSON.parse(e):{})}_binaryDecode(e){const t=new DataView(e),s=new TextDecoder;return this._decodeBroadcast(e,t,s)}_decodeBroadcast(e,t,s){const i=t.getUint8(1),n=t.getUint8(2);let a=this.HEADER_LENGTH+2;const o=s.decode(e.slice(a,a+i));a=a+i;const l=s.decode(e.slice(a,a+n));a=a+n;const c=JSON.parse(s.decode(e.slice(a,e.byteLength)));return{ref:null,topic:o,event:l,payload:c}}}class Ds{constructor(e,t){this.callback=e,this.timerCalc=t,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=t}reset(){this.tries=0,clearTimeout(this.timer)}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var _;(function(r){r.abstime="abstime",r.bool="bool",r.date="date",r.daterange="daterange",r.float4="float4",r.float8="float8",r.int2="int2",r.int4="int4",r.int4range="int4range",r.int8="int8",r.int8range="int8range",r.json="json",r.jsonb="jsonb",r.money="money",r.numeric="numeric",r.oid="oid",r.reltime="reltime",r.text="text",r.time="time",r.timestamp="timestamp",r.timestamptz="timestamptz",r.timetz="timetz",r.tsrange="tsrange",r.tstzrange="tstzrange"})(_||(_={}));const Gt=(r,e,t={})=>{var s;const i=(s=t.skipTypes)!==null&&s!==void 0?s:[];return Object.keys(e).reduce((n,a)=>(n[a]=rn(a,r,e,i),n),{})},rn=(r,e,t,s)=>{const i=e.find(o=>o.name===r),n=i==null?void 0:i.type,a=t[r];return n&&!s.includes(n)?Ls(n,a):wt(a)},Ls=(r,e)=>{if(r.charAt(0)==="_"){const t=r.slice(1,r.length);return ln(e,t)}switch(r){case _.bool:return nn(e);case _.float4:case _.float8:case _.int2:case _.int4:case _.int8:case _.numeric:case _.oid:return an(e);case _.json:case _.jsonb:return on(e);case _.timestamp:return un(e);case _.abstime:case _.date:case _.daterange:case _.int4range:case _.int8range:case _.money:case _.reltime:case _.text:case _.time:case _.timestamptz:case _.timetz:case _.tsrange:case _.tstzrange:return wt(e);default:return wt(e)}},wt=r=>r,nn=r=>{switch(r){case"t":return!0;case"f":return!1;default:return r}},an=r=>{if(typeof r=="string"){const e=parseFloat(r);if(!Number.isNaN(e))return e}return r},on=r=>{if(typeof r=="string")try{return JSON.parse(r)}catch(e){return console.log(`JSON parse error: ${e}`),r}return r},ln=(r,e)=>{if(typeof r!="string")return r;const t=r.length-1,s=r[t];if(r[0]==="{"&&s==="}"){let n;const a=r.slice(1,t);try{n=JSON.parse("["+a+"]")}catch{n=a?a.split(","):[]}return n.map(o=>Ls(e,o))}return r},un=r=>typeof r=="string"?r.replace(" ","T"):r,Us=r=>{let e=r;return e=e.replace(/^ws/i,"http"),e=e.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),e.replace(/\/+$/,"")};class ut{constructor(e,t,s={},i=Fs){this.channel=e,this.event=t,this.payload=s,this.timeout=i,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,t){var s;return this._hasReceived(e)&&t((s=this.receivedResp)===null||s===void 0?void 0:s.response),this.recHooks.push({status:e,callback:t}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=t=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=t,this._matchReceive(t)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,t){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:t})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:t}){this.recHooks.filter(s=>s.status===e).forEach(s=>s.callback(t))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var Wt;(function(r){r.SYNC="sync",r.JOIN="join",r.LEAVE="leave"})(Wt||(Wt={}));class Ce{constructor(e,t){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const s=(t==null?void 0:t.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(s.state,{},i=>{const{onJoin:n,onLeave:a,onSync:o}=this.caller;this.joinRef=this.channel._joinRef(),this.state=Ce.syncState(this.state,i,n,a),this.pendingDiffs.forEach(l=>{this.state=Ce.syncDiff(this.state,l,n,a)}),this.pendingDiffs=[],o()}),this.channel._on(s.diff,{},i=>{const{onJoin:n,onLeave:a,onSync:o}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(i):(this.state=Ce.syncDiff(this.state,i,n,a),o())}),this.onJoin((i,n,a)=>{this.channel._trigger("presence",{event:"join",key:i,currentPresences:n,newPresences:a})}),this.onLeave((i,n,a)=>{this.channel._trigger("presence",{event:"leave",key:i,currentPresences:n,leftPresences:a})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,t,s,i){const n=this.cloneDeep(e),a=this.transformState(t),o={},l={};return this.map(n,(c,u)=>{a[c]||(l[c]=u)}),this.map(a,(c,u)=>{const h=n[c];if(h){const d=u.map(m=>m.presence_ref),f=h.map(m=>m.presence_ref),p=u.filter(m=>f.indexOf(m.presence_ref)<0),g=h.filter(m=>d.indexOf(m.presence_ref)<0);p.length>0&&(o[c]=p),g.length>0&&(l[c]=g)}else o[c]=u}),this.syncDiff(n,{joins:o,leaves:l},s,i)}static syncDiff(e,t,s,i){const{joins:n,leaves:a}={joins:this.transformState(t.joins),leaves:this.transformState(t.leaves)};return s||(s=()=>{}),i||(i=()=>{}),this.map(n,(o,l)=>{var c;const u=(c=e[o])!==null&&c!==void 0?c:[];if(e[o]=this.cloneDeep(l),u.length>0){const h=e[o].map(f=>f.presence_ref),d=u.filter(f=>h.indexOf(f.presence_ref)<0);e[o].unshift(...d)}s(o,u,l)}),this.map(a,(o,l)=>{let c=e[o];if(!c)return;const u=l.map(h=>h.presence_ref);c=c.filter(h=>u.indexOf(h.presence_ref)<0),e[o]=c,i(o,c,l),c.length===0&&delete e[o]}),e}static map(e,t){return Object.getOwnPropertyNames(e).map(s=>t(s,e[s]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((t,s)=>{const i=e[s];return"metas"in i?t[s]=i.metas.map(n=>(n.presence_ref=n.phx_ref,delete n.phx_ref,delete n.phx_ref_prev,n)):t[s]=i,t},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var Zt;(function(r){r.ALL="*",r.INSERT="INSERT",r.UPDATE="UPDATE",r.DELETE="DELETE"})(Zt||(Zt={}));var Yt;(function(r){r.BROADCAST="broadcast",r.PRESENCE="presence",r.POSTGRES_CHANGES="postgres_changes"})(Yt||(Yt={}));var Qt;(function(r){r.SUBSCRIBED="SUBSCRIBED",r.TIMED_OUT="TIMED_OUT",r.CLOSED="CLOSED",r.CHANNEL_ERROR="CHANNEL_ERROR"})(Qt||(Qt={}));class Ft{constructor(e,t={config:{}},s){this.topic=e,this.params=t,this.socket=s,this.bindings={},this.state=I.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:""},private:!1},t.config),this.timeout=this.socket.timeout,this.joinPush=new ut(this,N.join,this.params,this.timeout),this.rejoinTimer=new Ds(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=I.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(i=>i.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=I.closed,this.socket._remove(this)}),this._onError(i=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,i),this.state=I.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=I.errored,this.rejoinTimer.scheduleTimeout())}),this._on(N.reply,{},(i,n)=>{this._trigger(this._replyEventName(n),i)}),this.presence=new Ce(this),this.broadcastEndpointURL=Us(this.socket.endPoint)+"/api/broadcast"}subscribe(e,t=this.timeout){var s,i;if(this.socket.isConnected()||this.socket.connect(),this.joinedOnce)throw"tried to subscribe multiple times. 'subscribe' can only be called a single time per channel instance";{const{config:{broadcast:n,presence:a,private:o}}=this.params;this._onError(u=>e&&e("CHANNEL_ERROR",u)),this._onClose(()=>e&&e("CLOSED"));const l={},c={broadcast:n,presence:a,postgres_changes:(i=(s=this.bindings.postgres_changes)===null||s===void 0?void 0:s.map(u=>u.filter))!==null&&i!==void 0?i:[],private:o};this.socket.accessToken&&(l.access_token=this.socket.accessToken),this.updateJoinPayload(Object.assign({config:c},l)),this.joinedOnce=!0,this._rejoin(t),this.joinPush.receive("ok",({postgres_changes:u})=>{var h;if(this.socket.accessToken&&this.socket.setAuth(this.socket.accessToken),u===void 0){e&&e("SUBSCRIBED");return}else{const d=this.bindings.postgres_changes,f=(h=d==null?void 0:d.length)!==null&&h!==void 0?h:0,p=[];for(let g=0;g<f;g++){const m=d[g],{filter:{event:w,schema:S,table:x,filter:E}}=m,O=u&&u[g];if(O&&O.event===w&&O.schema===S&&O.table===x&&O.filter===E)p.push(Object.assign(Object.assign({},m),{id:O.id}));else{this.unsubscribe(),e&&e("CHANNEL_ERROR",new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=p,e&&e("SUBSCRIBED");return}}).receive("error",u=>{e&&e("CHANNEL_ERROR",new Error(JSON.stringify(Object.values(u).join(", ")||"error")))}).receive("timeout",()=>{e&&e("TIMED_OUT")})}return this}presenceState(){return this.presence.state}async track(e,t={}){return await this.send({type:"presence",event:"track",payload:e},t.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,t,s){return this._on(e,t,s)}async send(e,t={}){var s,i;if(!this._canPush()&&e.type==="broadcast"){const{event:n,payload:a}=e,o={method:"POST",headers:{Authorization:this.socket.accessToken?`Bearer ${this.socket.accessToken}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:n,payload:a}]})};try{const l=await this._fetchWithTimeout(this.broadcastEndpointURL,o,(s=t.timeout)!==null&&s!==void 0?s:this.timeout);return await((i=l.body)===null||i===void 0?void 0:i.cancel()),l.ok?"ok":"error"}catch(l){return l.name==="AbortError"?"timed out":"error"}}else return new Promise(n=>{var a,o,l;const c=this._push(e.type,e,t.timeout||this.timeout);e.type==="broadcast"&&!(!((l=(o=(a=this.params)===null||a===void 0?void 0:a.config)===null||o===void 0?void 0:o.broadcast)===null||l===void 0)&&l.ack)&&n("ok"),c.receive("ok",()=>n("ok")),c.receive("error",()=>n("error")),c.receive("timeout",()=>n("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=I.leaving;const t=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(N.close,"leave",this._joinRef())};return this.rejoinTimer.reset(),this.joinPush.destroy(),new Promise(s=>{const i=new ut(this,N.leave,{},e);i.receive("ok",()=>{t(),s("ok")}).receive("timeout",()=>{t(),s("timed out")}).receive("error",()=>{s("error")}),i.send(),this._canPush()||i.trigger("ok",{})})}async _fetchWithTimeout(e,t,s){const i=new AbortController,n=setTimeout(()=>i.abort(),s),a=await this.socket.fetch(e,Object.assign(Object.assign({},t),{signal:i.signal}));return clearTimeout(n),a}_push(e,t,s=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let i=new ut(this,e,t,s);return this._canPush()?i.send():(i.startTimeout(),this.pushBuffer.push(i)),i}_onMessage(e,t,s){return t}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,t,s){var i,n;const a=e.toLocaleLowerCase(),{close:o,error:l,leave:c,join:u}=N;if(s&&[o,l,c,u].indexOf(a)>=0&&s!==this._joinRef())return;let d=this._onMessage(a,t,s);if(t&&!d)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(a)?(i=this.bindings.postgres_changes)===null||i===void 0||i.filter(f=>{var p,g,m;return((p=f.filter)===null||p===void 0?void 0:p.event)==="*"||((m=(g=f.filter)===null||g===void 0?void 0:g.event)===null||m===void 0?void 0:m.toLocaleLowerCase())===a}).map(f=>f.callback(d,s)):(n=this.bindings[a])===null||n===void 0||n.filter(f=>{var p,g,m,w,S,x;if(["broadcast","presence","postgres_changes"].includes(a))if("id"in f){const E=f.id,O=(p=f.filter)===null||p===void 0?void 0:p.event;return E&&((g=t.ids)===null||g===void 0?void 0:g.includes(E))&&(O==="*"||(O==null?void 0:O.toLocaleLowerCase())===((m=t.data)===null||m===void 0?void 0:m.type.toLocaleLowerCase()))}else{const E=(S=(w=f==null?void 0:f.filter)===null||w===void 0?void 0:w.event)===null||S===void 0?void 0:S.toLocaleLowerCase();return E==="*"||E===((x=t==null?void 0:t.event)===null||x===void 0?void 0:x.toLocaleLowerCase())}else return f.type.toLocaleLowerCase()===a}).map(f=>{if(typeof d=="object"&&"ids"in d){const p=d.data,{schema:g,table:m,commit_timestamp:w,type:S,errors:x}=p;d=Object.assign(Object.assign({},{schema:g,table:m,commit_timestamp:w,eventType:S,new:{},old:{},errors:x}),this._getPayloadRecords(p))}f.callback(d,s)})}_isClosed(){return this.state===I.closed}_isJoined(){return this.state===I.joined}_isJoining(){return this.state===I.joining}_isLeaving(){return this.state===I.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,t,s){const i=e.toLocaleLowerCase(),n={type:i,filter:t,callback:s};return this.bindings[i]?this.bindings[i].push(n):this.bindings[i]=[n],this}_off(e,t){const s=e.toLocaleLowerCase();return this.bindings[s]=this.bindings[s].filter(i=>{var n;return!(((n=i.type)===null||n===void 0?void 0:n.toLocaleLowerCase())===s&&Ft.isEqual(i.filter,t))}),this}static isEqual(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const s in e)if(e[s]!==t[s])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(N.close,{},e)}_onError(e){this._on(N.error,{},t=>e(t))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=I.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const t={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(t.new=Gt(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(t.old=Gt(e.columns,e.old_record)),t}}const cn=()=>{},hn=typeof WebSocket<"u";class dn{constructor(e,t){var s;this.accessToken=null,this.apiKey=null,this.channels=[],this.endPoint="",this.httpEndpoint="",this.headers=Xi,this.params={},this.timeout=Fs,this.heartbeatIntervalMs=3e4,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.ref=0,this.logger=cn,this.conn=null,this.sendBuffer=[],this.serializer=new sn,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this._resolveFetch=n=>{let a;return n?a=n:typeof fetch>"u"?a=(...o)=>_e(async()=>{const{default:l}=await Promise.resolve().then(()=>we);return{default:l}},void 0,import.meta.url).then(({default:l})=>l(...o)):a=fetch,(...o)=>a(...o)},this.endPoint=`${e}/${bt.websocket}`,this.httpEndpoint=Us(e),t!=null&&t.transport?this.transport=t.transport:this.transport=null,t!=null&&t.params&&(this.params=t.params),t!=null&&t.headers&&(this.headers=Object.assign(Object.assign({},this.headers),t.headers)),t!=null&&t.timeout&&(this.timeout=t.timeout),t!=null&&t.logger&&(this.logger=t.logger),t!=null&&t.heartbeatIntervalMs&&(this.heartbeatIntervalMs=t.heartbeatIntervalMs);const i=(s=t==null?void 0:t.params)===null||s===void 0?void 0:s.apikey;i&&(this.accessToken=i,this.apiKey=i),this.reconnectAfterMs=t!=null&&t.reconnectAfterMs?t.reconnectAfterMs:n=>[1e3,2e3,5e3,1e4][n-1]||1e4,this.encode=t!=null&&t.encode?t.encode:(n,a)=>a(JSON.stringify(n)),this.decode=t!=null&&t.decode?t.decode:this.serializer.decode.bind(this.serializer),this.reconnectTimer=new Ds(async()=>{this.disconnect(),this.connect()},this.reconnectAfterMs),this.fetch=this._resolveFetch(t==null?void 0:t.fetch)}connect(){if(!this.conn){if(this.transport){this.conn=new this.transport(this._endPointURL(),void 0,{headers:this.headers});return}if(hn){this.conn=new WebSocket(this._endPointURL()),this.setupConnection();return}this.conn=new fn(this._endPointURL(),void 0,{close:()=>{this.conn=null}}),_e(async()=>{const{default:e}=await import("./DP9xwUSQ.js").then(t=>t.b);return{default:e}},__vite__mapDeps([0,1]),import.meta.url).then(({default:e})=>{this.conn=new e(this._endPointURL(),void 0,{headers:this.headers}),this.setupConnection()})}}disconnect(e,t){this.conn&&(this.conn.onclose=function(){},e?this.conn.close(e,t??""):this.conn.close(),this.conn=null,this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.reset())}getChannels(){return this.channels}async removeChannel(e){const t=await e.unsubscribe();return this.channels.length===0&&this.disconnect(),t}async removeAllChannels(){const e=await Promise.all(this.channels.map(t=>t.unsubscribe()));return this.disconnect(),e}log(e,t,s){this.logger(e,t,s)}connectionState(){switch(this.conn&&this.conn.readyState){case ye.connecting:return se.Connecting;case ye.open:return se.Open;case ye.closing:return se.Closing;default:return se.Closed}}isConnected(){return this.connectionState()===se.Open}channel(e,t={config:{}}){const s=new Ft(`realtime:${e}`,t,this);return this.channels.push(s),s}push(e){const{topic:t,event:s,payload:i,ref:n}=e,a=()=>{this.encode(e,o=>{var l;(l=this.conn)===null||l===void 0||l.send(o)})};this.log("push",`${t} ${s} (${n})`,i),this.isConnected()?a():this.sendBuffer.push(a)}setAuth(e){this.accessToken=e,this.channels.forEach(t=>{e&&t.updateJoinPayload({access_token:e}),t.joinedOnce&&t._isJoined()&&t._push(N.access_token,{access_token:e})})}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let t=this.channels.find(s=>s.topic===e&&(s._isJoined()||s._isJoining()));t&&(this.log("transport",`leaving duplicate topic "${e}"`),t.unsubscribe())}_remove(e){this.channels=this.channels.filter(t=>t._joinRef()!==e._joinRef())}setupConnection(){this.conn&&(this.conn.binaryType="arraybuffer",this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_endPointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:en}))}_onConnMessage(e){this.decode(e.data,t=>{let{topic:s,event:i,payload:n,ref:a}=t;(a&&a===this.pendingHeartbeatRef||i===(n==null?void 0:n.type))&&(this.pendingHeartbeatRef=null),this.log("receive",`${n.status||""} ${s} ${i} ${a&&"("+a+")"||""}`,n),this.channels.filter(o=>o._isMember(s)).forEach(o=>o._trigger(i,n,a)),this.stateChangeCallbacks.message.forEach(o=>o(t))})}_onConnOpen(){this.log("transport",`connected to ${this._endPointURL()}`),this._flushSendBuffer(),this.reconnectTimer.reset(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this._sendHeartbeat(),this.heartbeatIntervalMs),this.stateChangeCallbacks.open.forEach(e=>e())}_onConnClose(e){this.log("transport","close",e),this._triggerChanError(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach(t=>t(e))}_onConnError(e){this.log("transport",e.message),this._triggerChanError(),this.stateChangeCallbacks.error.forEach(t=>t(e))}_triggerChanError(){this.channels.forEach(e=>e._trigger(N.error))}_appendParams(e,t){if(Object.keys(t).length===0)return e;const s=e.match(/\?/)?"&":"?",i=new URLSearchParams(t);return`${e}${s}${i}`}_flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_sendHeartbeat(){var e;if(this.isConnected()){if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),(e=this.conn)===null||e===void 0||e.close(tn,"hearbeat timeout");return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.setAuth(this.accessToken)}}}class fn{constructor(e,t,s){this.binaryType="arraybuffer",this.onclose=()=>{},this.onerror=()=>{},this.onmessage=()=>{},this.onopen=()=>{},this.readyState=ye.connecting,this.send=()=>{},this.url=null,this.url=e,this.close=s.close}}class Dt extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function T(r){return typeof r=="object"&&r!==null&&"__isStorageError"in r}class pn extends Dt{constructor(e,t){super(e),this.name="StorageApiError",this.status=t}toJSON(){return{name:this.name,message:this.message,status:this.status}}}class Xt extends Dt{constructor(e,t){super(e),this.name="StorageUnknownError",this.originalError=t}}var gn=function(r,e,t,s){function i(n){return n instanceof t?n:new t(function(a){a(n)})}return new(t||(t=Promise))(function(n,a){function o(u){try{c(s.next(u))}catch(h){a(h)}}function l(u){try{c(s.throw(u))}catch(h){a(h)}}function c(u){u.done?n(u.value):i(u.value).then(o,l)}c((s=s.apply(r,e||[])).next())})};const Ns=r=>{let e;return r?e=r:typeof fetch>"u"?e=(...t)=>_e(async()=>{const{default:s}=await Promise.resolve().then(()=>we);return{default:s}},void 0,import.meta.url).then(({default:s})=>s(...t)):e=fetch,(...t)=>e(...t)},mn=()=>gn(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield _e(()=>Promise.resolve().then(()=>we),void 0,import.meta.url)).Response:Response});var ke=function(r,e,t,s){function i(n){return n instanceof t?n:new t(function(a){a(n)})}return new(t||(t=Promise))(function(n,a){function o(u){try{c(s.next(u))}catch(h){a(h)}}function l(u){try{c(s.throw(u))}catch(h){a(h)}}function c(u){u.done?n(u.value):i(u.value).then(o,l)}c((s=s.apply(r,e||[])).next())})};const ct=r=>r.msg||r.message||r.error_description||r.error||JSON.stringify(r),yn=(r,e)=>ke(void 0,void 0,void 0,function*(){const t=yield mn();r instanceof t?r.json().then(s=>{e(new pn(ct(s),r.status||500))}).catch(s=>{e(new Xt(ct(s),s))}):e(new Xt(ct(r),r))}),vn=(r,e,t,s)=>{const i={method:r,headers:(e==null?void 0:e.headers)||{}};return r==="GET"?i:(i.headers=Object.assign({"Content-Type":"application/json"},e==null?void 0:e.headers),i.body=JSON.stringify(s),Object.assign(Object.assign({},i),t))};function it(r,e,t,s,i,n){return ke(this,void 0,void 0,function*(){return new Promise((a,o)=>{r(t,vn(e,s,i,n)).then(l=>{if(!l.ok)throw l;return s!=null&&s.noResolveJson?l:l.json()}).then(l=>a(l)).catch(l=>yn(l,o))})})}function kt(r,e,t,s){return ke(this,void 0,void 0,function*(){return it(r,"GET",e,t,s)})}function W(r,e,t,s,i){return ke(this,void 0,void 0,function*(){return it(r,"POST",e,s,i,t)})}function _n(r,e,t,s,i){return ke(this,void 0,void 0,function*(){return it(r,"PUT",e,s,i,t)})}function zs(r,e,t,s,i){return ke(this,void 0,void 0,function*(){return it(r,"DELETE",e,s,i,t)})}var F=function(r,e,t,s){function i(n){return n instanceof t?n:new t(function(a){a(n)})}return new(t||(t=Promise))(function(n,a){function o(u){try{c(s.next(u))}catch(h){a(h)}}function l(u){try{c(s.throw(u))}catch(h){a(h)}}function c(u){u.done?n(u.value):i(u.value).then(o,l)}c((s=s.apply(r,e||[])).next())})};const bn={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},es={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class wn{constructor(e,t={},s,i){this.url=e,this.headers=t,this.bucketId=s,this.fetch=Ns(i)}uploadOrUpdate(e,t,s,i){return F(this,void 0,void 0,function*(){try{let n;const a=Object.assign(Object.assign({},es),i),o=Object.assign(Object.assign({},this.headers),e==="POST"&&{"x-upsert":String(a.upsert)});typeof Blob<"u"&&s instanceof Blob?(n=new FormData,n.append("cacheControl",a.cacheControl),n.append("",s)):typeof FormData<"u"&&s instanceof FormData?(n=s,n.append("cacheControl",a.cacheControl)):(n=s,o["cache-control"]=`max-age=${a.cacheControl}`,o["content-type"]=a.contentType);const l=this._removeEmptyFolders(t),c=this._getFinalPath(l),u=yield this.fetch(`${this.url}/object/${c}`,Object.assign({method:e,body:n,headers:o},a!=null&&a.duplex?{duplex:a.duplex}:{})),h=yield u.json();return u.ok?{data:{path:l,id:h.Id,fullPath:h.Key},error:null}:{data:null,error:h}}catch(n){if(T(n))return{data:null,error:n};throw n}})}upload(e,t,s){return F(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",e,t,s)})}uploadToSignedUrl(e,t,s,i){return F(this,void 0,void 0,function*(){const n=this._removeEmptyFolders(e),a=this._getFinalPath(n),o=new URL(this.url+`/object/upload/sign/${a}`);o.searchParams.set("token",t);try{let l;const c=Object.assign({upsert:es.upsert},i),u=Object.assign(Object.assign({},this.headers),{"x-upsert":String(c.upsert)});typeof Blob<"u"&&s instanceof Blob?(l=new FormData,l.append("cacheControl",c.cacheControl),l.append("",s)):typeof FormData<"u"&&s instanceof FormData?(l=s,l.append("cacheControl",c.cacheControl)):(l=s,u["cache-control"]=`max-age=${c.cacheControl}`,u["content-type"]=c.contentType);const h=yield this.fetch(o.toString(),{method:"PUT",body:l,headers:u}),d=yield h.json();return h.ok?{data:{path:n,fullPath:d.Key},error:null}:{data:null,error:d}}catch(l){if(T(l))return{data:null,error:l};throw l}})}createSignedUploadUrl(e,t){return F(this,void 0,void 0,function*(){try{let s=this._getFinalPath(e);const i=Object.assign({},this.headers);t!=null&&t.upsert&&(i["x-upsert"]="true");const n=yield W(this.fetch,`${this.url}/object/upload/sign/${s}`,{},{headers:i}),a=new URL(this.url+n.url),o=a.searchParams.get("token");if(!o)throw new Dt("No token returned by API");return{data:{signedUrl:a.toString(),path:e,token:o},error:null}}catch(s){if(T(s))return{data:null,error:s};throw s}})}update(e,t,s){return F(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",e,t,s)})}move(e,t,s){return F(this,void 0,void 0,function*(){try{return{data:yield W(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:s==null?void 0:s.destinationBucket},{headers:this.headers}),error:null}}catch(i){if(T(i))return{data:null,error:i};throw i}})}copy(e,t,s){return F(this,void 0,void 0,function*(){try{return{data:{path:(yield W(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:s==null?void 0:s.destinationBucket},{headers:this.headers})).Key},error:null}}catch(i){if(T(i))return{data:null,error:i};throw i}})}createSignedUrl(e,t,s){return F(this,void 0,void 0,function*(){try{let i=this._getFinalPath(e),n=yield W(this.fetch,`${this.url}/object/sign/${i}`,Object.assign({expiresIn:t},s!=null&&s.transform?{transform:s.transform}:{}),{headers:this.headers});const a=s!=null&&s.download?`&download=${s.download===!0?"":s.download}`:"";return n={signedUrl:encodeURI(`${this.url}${n.signedURL}${a}`)},{data:n,error:null}}catch(i){if(T(i))return{data:null,error:i};throw i}})}createSignedUrls(e,t,s){return F(this,void 0,void 0,function*(){try{const i=yield W(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:t,paths:e},{headers:this.headers}),n=s!=null&&s.download?`&download=${s.download===!0?"":s.download}`:"";return{data:i.map(a=>Object.assign(Object.assign({},a),{signedUrl:a.signedURL?encodeURI(`${this.url}${a.signedURL}${n}`):null})),error:null}}catch(i){if(T(i))return{data:null,error:i};throw i}})}download(e,t){return F(this,void 0,void 0,function*(){const i=typeof(t==null?void 0:t.transform)<"u"?"render/image/authenticated":"object",n=this.transformOptsToQueryString((t==null?void 0:t.transform)||{}),a=n?`?${n}`:"";try{const o=this._getFinalPath(e);return{data:yield(yield kt(this.fetch,`${this.url}/${i}/${o}${a}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(o){if(T(o))return{data:null,error:o};throw o}})}getPublicUrl(e,t){const s=this._getFinalPath(e),i=[],n=t!=null&&t.download?`download=${t.download===!0?"":t.download}`:"";n!==""&&i.push(n);const o=typeof(t==null?void 0:t.transform)<"u"?"render/image":"object",l=this.transformOptsToQueryString((t==null?void 0:t.transform)||{});l!==""&&i.push(l);let c=i.join("&");return c!==""&&(c=`?${c}`),{data:{publicUrl:encodeURI(`${this.url}/${o}/public/${s}${c}`)}}}remove(e){return F(this,void 0,void 0,function*(){try{return{data:yield zs(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(t){if(T(t))return{data:null,error:t};throw t}})}list(e,t,s){return F(this,void 0,void 0,function*(){try{const i=Object.assign(Object.assign(Object.assign({},bn),t),{prefix:e||""});return{data:yield W(this.fetch,`${this.url}/object/list/${this.bucketId}`,i,{headers:this.headers},s),error:null}}catch(i){if(T(i))return{data:null,error:i};throw i}})}_getFinalPath(e){return`${this.bucketId}/${e}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const t=[];return e.width&&t.push(`width=${e.width}`),e.height&&t.push(`height=${e.height}`),e.resize&&t.push(`resize=${e.resize}`),e.format&&t.push(`format=${e.format}`),e.quality&&t.push(`quality=${e.quality}`),t.join("&")}}const kn="2.6.0",Sn={"X-Client-Info":`storage-js/${kn}`};var de=function(r,e,t,s){function i(n){return n instanceof t?n:new t(function(a){a(n)})}return new(t||(t=Promise))(function(n,a){function o(u){try{c(s.next(u))}catch(h){a(h)}}function l(u){try{c(s.throw(u))}catch(h){a(h)}}function c(u){u.done?n(u.value):i(u.value).then(o,l)}c((s=s.apply(r,e||[])).next())})};class $n{constructor(e,t={},s){this.url=e,this.headers=Object.assign(Object.assign({},Sn),t),this.fetch=Ns(s)}listBuckets(){return de(this,void 0,void 0,function*(){try{return{data:yield kt(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(e){if(T(e))return{data:null,error:e};throw e}})}getBucket(e){return de(this,void 0,void 0,function*(){try{return{data:yield kt(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(t){if(T(t))return{data:null,error:t};throw t}})}createBucket(e,t={public:!1}){return de(this,void 0,void 0,function*(){try{return{data:yield W(this.fetch,`${this.url}/bucket`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(s){if(T(s))return{data:null,error:s};throw s}})}updateBucket(e,t){return de(this,void 0,void 0,function*(){try{return{data:yield _n(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(s){if(T(s))return{data:null,error:s};throw s}})}emptyBucket(e){return de(this,void 0,void 0,function*(){try{return{data:yield W(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(t){if(T(t))return{data:null,error:t};throw t}})}deleteBucket(e){return de(this,void 0,void 0,function*(){try{return{data:yield zs(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(t){if(T(t))return{data:null,error:t};throw t}})}}class En extends $n{constructor(e,t={},s){super(e,t,s)}from(e){return new wn(this.url,this.headers,e,this.fetch)}}const On="2.44.3";let je="";typeof Deno<"u"?je="deno":typeof document<"u"?je="web":typeof navigator<"u"&&navigator.product==="ReactNative"?je="react-native":je="node";const Tn={"X-Client-Info":`supabase-js-${je}/${On}`},xn={headers:Tn},An={schema:"public"},jn={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},Cn={};var Pn=function(r,e,t,s){function i(n){return n instanceof t?n:new t(function(a){a(n)})}return new(t||(t=Promise))(function(n,a){function o(u){try{c(s.next(u))}catch(h){a(h)}}function l(u){try{c(s.throw(u))}catch(h){a(h)}}function c(u){u.done?n(u.value):i(u.value).then(o,l)}c((s=s.apply(r,e||[])).next())})};const In=r=>{let e;return r?e=r:typeof fetch>"u"?e=Es:e=fetch,(...t)=>e(...t)},Rn=()=>typeof Headers>"u"?Os:Headers,Fn=(r,e,t)=>{const s=In(t),i=Rn();return(n,a)=>Pn(void 0,void 0,void 0,function*(){var o;const l=(o=yield e())!==null&&o!==void 0?o:r;let c=new i(a==null?void 0:a.headers);return c.has("apikey")||c.set("apikey",r),c.has("Authorization")||c.set("Authorization",`Bearer ${l}`),s(n,Object.assign(Object.assign({},a),{headers:c}))})};function Dn(r){return r.replace(/\/$/,"")}function Ln(r,e){const{db:t,auth:s,realtime:i,global:n}=r,{db:a,auth:o,realtime:l,global:c}=e;return{db:Object.assign(Object.assign({},a),t),auth:Object.assign(Object.assign({},o),s),realtime:Object.assign(Object.assign({},l),i),global:Object.assign(Object.assign({},c),n)}}const Bs="2.64.2",Un="http://localhost:9999",Nn="supabase.auth.token",zn={"X-Client-Info":`gotrue-js/${Bs}`},ts=10,St="X-Supabase-Api-Version",Ms={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}};function Bn(r){return Math.round(Date.now()/1e3)+r}function Mn(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(r){const e=Math.random()*16|0;return(r=="x"?e:e&3|8).toString(16)})}const U=()=>typeof document<"u",Q={tested:!1,writable:!1},Pe=()=>{if(!U())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Q.tested)return Q.writable;const r=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(r,r),globalThis.localStorage.removeItem(r),Q.tested=!0,Q.writable=!0}catch{Q.tested=!0,Q.writable=!1}return Q.writable};function ht(r){const e={},t=new URL(r);if(t.hash&&t.hash[0]==="#")try{new URLSearchParams(t.hash.substring(1)).forEach((i,n)=>{e[n]=i})}catch{}return t.searchParams.forEach((s,i)=>{e[i]=s}),e}const qs=r=>{let e;return r?e=r:typeof fetch>"u"?e=(...t)=>_e(async()=>{const{default:s}=await Promise.resolve().then(()=>we);return{default:s}},void 0,import.meta.url).then(({default:s})=>s(...t)):e=fetch,(...t)=>e(...t)},qn=r=>typeof r=="object"&&r!==null&&"status"in r&&"ok"in r&&"json"in r&&typeof r.json=="function",Vs=async(r,e,t)=>{await r.setItem(e,JSON.stringify(t))},Ne=async(r,e)=>{const t=await r.getItem(e);if(!t)return null;try{return JSON.parse(t)}catch{return t}},dt=async(r,e)=>{await r.removeItem(e)};function Vn(r){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";let t="",s,i,n,a,o,l,c,u=0;for(r=r.replace("-","+").replace("_","/");u<r.length;)a=e.indexOf(r.charAt(u++)),o=e.indexOf(r.charAt(u++)),l=e.indexOf(r.charAt(u++)),c=e.indexOf(r.charAt(u++)),s=a<<2|o>>4,i=(o&15)<<4|l>>2,n=(l&3)<<6|c,t=t+String.fromCharCode(s),l!=64&&i!=0&&(t=t+String.fromCharCode(i)),c!=64&&n!=0&&(t=t+String.fromCharCode(n));return t}class nt{constructor(){this.promise=new nt.promiseConstructor((e,t)=>{this.resolve=e,this.reject=t})}}nt.promiseConstructor=Promise;function ss(r){const e=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}=?$|[a-z0-9_-]{2}(==)?$)$/i,t=r.split(".");if(t.length!==3)throw new Error("JWT is not valid: not a JWT structure");if(!e.test(t[1]))throw new Error("JWT is not valid: payload is not in base64url format");const s=t[1];return JSON.parse(Vn(s))}async function Jn(r){return await new Promise(e=>{setTimeout(()=>e(null),r)})}function Hn(r,e){return new Promise((s,i)=>{(async()=>{for(let n=0;n<1/0;n++)try{const a=await r(n);if(!e(n,null,a)){s(a);return}}catch(a){if(!e(n,a)){i(a);return}}})()})}function Kn(r){return("0"+r.toString(16)).substr(-2)}function Gn(){const e=new Uint32Array(56);if(typeof crypto>"u"){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",s=t.length;let i="";for(let n=0;n<56;n++)i+=t.charAt(Math.floor(Math.random()*s));return i}return crypto.getRandomValues(e),Array.from(e,Kn).join("")}async function Wn(r){const t=new TextEncoder().encode(r),s=await crypto.subtle.digest("SHA-256",t),i=new Uint8Array(s);return Array.from(i).map(n=>String.fromCharCode(n)).join("")}function Zn(r){return btoa(r).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function Yn(r){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),r;const t=await Wn(r);return Zn(t)}async function fe(r,e,t=!1){const s=Gn();let i=s;t&&(i+="/PASSWORD_RECOVERY"),await Vs(r,`${e}-code-verifier`,i);const n=await Yn(s);return[n,s===n?"plain":"s256"]}const Qn=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function Xn(r){const e=r.headers.get(St);if(!e||!e.match(Qn))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch{return null}}class Lt extends Error{constructor(e,t,s){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=t,this.code=s}}function y(r){return typeof r=="object"&&r!==null&&"__isAuthError"in r}class ea extends Lt{constructor(e,t,s){super(e,t,s),this.name="AuthApiError",this.status=t,this.code=s}}function ta(r){return y(r)&&r.name==="AuthApiError"}class Js extends Lt{constructor(e,t){super(e),this.name="AuthUnknownError",this.originalError=t}}class le extends Lt{constructor(e,t,s,i){super(e,s,i),this.name=t,this.status=s}}class X extends le{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}class ft extends le{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class ze extends le{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class Be extends le{constructor(e,t=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class rs extends le{constructor(e,t=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class $t extends le{constructor(e,t){super(e,"AuthRetryableFetchError",t,void 0)}}function pt(r){return y(r)&&r.name==="AuthRetryableFetchError"}class is extends le{constructor(e,t,s){super(e,"AuthWeakPasswordError",t,"weak_password"),this.reasons=s}}var sa=function(r,e){var t={};for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&e.indexOf(s)<0&&(t[s]=r[s]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,s=Object.getOwnPropertySymbols(r);i<s.length;i++)e.indexOf(s[i])<0&&Object.prototype.propertyIsEnumerable.call(r,s[i])&&(t[s[i]]=r[s[i]]);return t};const te=r=>r.msg||r.message||r.error_description||r.error||JSON.stringify(r),ra=[502,503,504];async function ns(r){var e;if(!qn(r))throw new $t(te(r),0);if(ra.includes(r.status))throw new $t(te(r),r.status);let t;try{t=await r.json()}catch(n){throw new Js(te(n),n)}let s;const i=Xn(r);if(i&&i.getTime()>=Ms["2024-01-01"].timestamp&&typeof t=="object"&&t&&typeof t.code=="string"?s=t.code:typeof t=="object"&&t&&typeof t.error_code=="string"&&(s=t.error_code),s){if(s==="weak_password")throw new is(te(t),r.status,((e=t.weak_password)===null||e===void 0?void 0:e.reasons)||[])}else if(typeof t=="object"&&t&&typeof t.weak_password=="object"&&t.weak_password&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.reasons.reduce((n,a)=>n&&typeof a=="string",!0))throw new is(te(t),r.status,t.weak_password.reasons);throw new ea(te(t),r.status||500,s)}const ia=(r,e,t,s)=>{const i={method:r,headers:(e==null?void 0:e.headers)||{}};return r==="GET"?i:(i.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e==null?void 0:e.headers),i.body=JSON.stringify(s),Object.assign(Object.assign({},i),t))};async function v(r,e,t,s){var i;const n=Object.assign({},s==null?void 0:s.headers);n[St]||(n[St]=Ms["2024-01-01"].name),s!=null&&s.jwt&&(n.Authorization=`Bearer ${s.jwt}`);const a=(i=s==null?void 0:s.query)!==null&&i!==void 0?i:{};s!=null&&s.redirectTo&&(a.redirect_to=s.redirectTo);const o=Object.keys(a).length?"?"+new URLSearchParams(a).toString():"",l=await na(r,e,t+o,{headers:n,noResolveJson:s==null?void 0:s.noResolveJson},{},s==null?void 0:s.body);return s!=null&&s.xform?s==null?void 0:s.xform(l):{data:Object.assign({},l),error:null}}async function na(r,e,t,s,i,n){const a=ia(e,s,i,n);let o;try{o=await r(t,Object.assign({},a))}catch(l){throw console.error(l),new $t(te(l),0)}if(o.ok||await ns(o),s!=null&&s.noResolveJson)return o;try{return await o.json()}catch(l){await ns(l)}}function G(r){var e;let t=null;ua(r)&&(t=Object.assign({},r),r.expires_at||(t.expires_at=Bn(r.expires_in)));const s=(e=r.user)!==null&&e!==void 0?e:r;return{data:{session:t,user:s},error:null}}function as(r){const e=G(r);return!e.error&&r.weak_password&&typeof r.weak_password=="object"&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.message&&typeof r.weak_password.message=="string"&&r.weak_password.reasons.reduce((t,s)=>t&&typeof s=="string",!0)&&(e.data.weak_password=r.weak_password),e}function Z(r){var e;return{data:{user:(e=r.user)!==null&&e!==void 0?e:r},error:null}}function aa(r){return{data:r,error:null}}function oa(r){const{action_link:e,email_otp:t,hashed_token:s,redirect_to:i,verification_type:n}=r,a=sa(r,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),o={action_link:e,email_otp:t,hashed_token:s,redirect_to:i,verification_type:n},l=Object.assign({},a);return{data:{properties:o,user:l},error:null}}function la(r){return r}function ua(r){return r.access_token&&r.refresh_token&&r.expires_in}var ca=function(r,e){var t={};for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&e.indexOf(s)<0&&(t[s]=r[s]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,s=Object.getOwnPropertySymbols(r);i<s.length;i++)e.indexOf(s[i])<0&&Object.prototype.propertyIsEnumerable.call(r,s[i])&&(t[s[i]]=r[s[i]]);return t};class ha{constructor({url:e="",headers:t={},fetch:s}){this.url=e,this.headers=t,this.fetch=qs(s),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(e,t="global"){try{return await v(this.fetch,"POST",`${this.url}/logout?scope=${t}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(s){if(y(s))return{data:null,error:s};throw s}}async inviteUserByEmail(e,t={}){try{return await v(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:t.data},headers:this.headers,redirectTo:t.redirectTo,xform:Z})}catch(s){if(y(s))return{data:{user:null},error:s};throw s}}async generateLink(e){try{const{options:t}=e,s=ca(e,["options"]),i=Object.assign(Object.assign({},s),t);return"newEmail"in s&&(i.new_email=s==null?void 0:s.newEmail,delete i.newEmail),await v(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:i,headers:this.headers,xform:oa,redirectTo:t==null?void 0:t.redirectTo})}catch(t){if(y(t))return{data:{properties:null,user:null},error:t};throw t}}async createUser(e){try{return await v(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:Z})}catch(t){if(y(t))return{data:{user:null},error:t};throw t}}async listUsers(e){var t,s,i,n,a,o,l;try{const c={nextPage:null,lastPage:0,total:0},u=await v(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(s=(t=e==null?void 0:e.page)===null||t===void 0?void 0:t.toString())!==null&&s!==void 0?s:"",per_page:(n=(i=e==null?void 0:e.perPage)===null||i===void 0?void 0:i.toString())!==null&&n!==void 0?n:""},xform:la});if(u.error)throw u.error;const h=await u.json(),d=(a=u.headers.get("x-total-count"))!==null&&a!==void 0?a:0,f=(l=(o=u.headers.get("link"))===null||o===void 0?void 0:o.split(","))!==null&&l!==void 0?l:[];return f.length>0&&(f.forEach(p=>{const g=parseInt(p.split(";")[0].split("=")[1].substring(0,1)),m=JSON.parse(p.split(";")[1].split("=")[1]);c[`${m}Page`]=g}),c.total=parseInt(d)),{data:Object.assign(Object.assign({},h),c),error:null}}catch(c){if(y(c))return{data:{users:[]},error:c};throw c}}async getUserById(e){try{return await v(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:Z})}catch(t){if(y(t))return{data:{user:null},error:t};throw t}}async updateUserById(e,t){try{return await v(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:t,headers:this.headers,xform:Z})}catch(s){if(y(s))return{data:{user:null},error:s};throw s}}async deleteUser(e,t=!1){try{return await v(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:t},xform:Z})}catch(s){if(y(s))return{data:{user:null},error:s};throw s}}async _listFactors(e){try{const{data:t,error:s}=await v(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:i=>({data:{factors:i},error:null})});return{data:t,error:s}}catch(t){if(y(t))return{data:null,error:t};throw t}}async _deleteFactor(e){try{return{data:await v(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(t){if(y(t))return{data:null,error:t};throw t}}}const da={getItem:r=>Pe()?globalThis.localStorage.getItem(r):null,setItem:(r,e)=>{Pe()&&globalThis.localStorage.setItem(r,e)},removeItem:r=>{Pe()&&globalThis.localStorage.removeItem(r)}};function os(r={}){return{getItem:e=>r[e]||null,setItem:(e,t)=>{r[e]=t},removeItem:e=>{delete r[e]}}}function fa(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const pe={debug:!!(globalThis&&Pe()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class Hs extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class pa extends Hs{}async function ga(r,e,t){pe.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",r,e);const s=new globalThis.AbortController;return e>0&&setTimeout(()=>{s.abort(),pe.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",r)},e),await globalThis.navigator.locks.request(r,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:s.signal},async i=>{if(i){pe.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",r,i.name);try{return await t()}finally{pe.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",r,i.name)}}else{if(e===0)throw pe.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",r),new pa(`Acquiring an exclusive Navigator LockManager lock "${r}" immediately failed`);if(pe.debug)try{const n=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(n,null,"  "))}catch(n){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",n)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await t()}})}fa();const ma={url:Un,storageKey:Nn,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:zn,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1},Ae=30*1e3,ls=3;async function us(r,e,t){return await t()}class Ie{constructor(e){var t,s;this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=Ie.nextInstanceID,Ie.nextInstanceID+=1,this.instanceID>0&&U()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const i=Object.assign(Object.assign({},ma),e);if(this.logDebugMessages=!!i.debug,typeof i.debug=="function"&&(this.logger=i.debug),this.persistSession=i.persistSession,this.storageKey=i.storageKey,this.autoRefreshToken=i.autoRefreshToken,this.admin=new ha({url:i.url,headers:i.headers,fetch:i.fetch}),this.url=i.url,this.headers=i.headers,this.fetch=qs(i.fetch),this.lock=i.lock||us,this.detectSessionInUrl=i.detectSessionInUrl,this.flowType=i.flowType,this.hasCustomAuthorizationHeader=i.hasCustomAuthorizationHeader,i.lock?this.lock=i.lock:U()&&(!((t=globalThis==null?void 0:globalThis.navigator)===null||t===void 0)&&t.locks)?this.lock=ga:this.lock=us,this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?i.storage?this.storage=i.storage:Pe()?this.storage=da:(this.memoryStorage={},this.storage=os(this.memoryStorage)):(this.memoryStorage={},this.storage=os(this.memoryStorage)),U()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(n){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",n)}(s=this.broadcastChannel)===null||s===void 0||s.addEventListener("message",async n=>{this._debug("received broadcast notification from other tab or client",n),await this._notifyAllSubscribers(n.data.event,n.data.session,!1)})}this.initialize()}_debug(...e){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${Bs}) ${new Date().toISOString()}`,...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){try{const e=U()?await this._isPKCEFlow():!1;if(this._debug("#_initialize()","begin","is PKCE flow",e),e||this.detectSessionInUrl&&this._isImplicitGrantFlow()){const{data:t,error:s}=await this._getSessionFromURL(e);if(s)return this._debug("#_initialize()","error detecting session from URL",s),(s==null?void 0:s.message)==="Identity is already linked"||(s==null?void 0:s.message)==="Identity is already linked to another user"?{error:s}:(await this._removeSession(),{error:s});const{session:i,redirectType:n}=t;return this._debug("#_initialize()","detected session in URL",i,"redirect type",n),await this._saveSession(i),setTimeout(async()=>{n==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",i):await this._notifyAllSubscribers("SIGNED_IN",i)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(e){return y(e)?{error:e}:{error:new Js("Unexpected error during initialization",e)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var t,s,i;try{await this._removeSession();const n=await v(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(s=(t=e==null?void 0:e.options)===null||t===void 0?void 0:t.data)!==null&&s!==void 0?s:{},gotrue_meta_security:{captcha_token:(i=e==null?void 0:e.options)===null||i===void 0?void 0:i.captchaToken}},xform:G}),{data:a,error:o}=n;if(o||!a)return{data:{user:null,session:null},error:o};const l=a.session,c=a.user;return a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",l)),{data:{user:c,session:l},error:null}}catch(n){if(y(n))return{data:{user:null,session:null},error:n};throw n}}async signUp(e){var t,s,i;try{await this._removeSession();let n;if("email"in e){const{email:u,password:h,options:d}=e;let f=null,p=null;this.flowType==="pkce"&&([f,p]=await fe(this.storage,this.storageKey)),n=await v(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:d==null?void 0:d.emailRedirectTo,body:{email:u,password:h,data:(t=d==null?void 0:d.data)!==null&&t!==void 0?t:{},gotrue_meta_security:{captcha_token:d==null?void 0:d.captchaToken},code_challenge:f,code_challenge_method:p},xform:G})}else if("phone"in e){const{phone:u,password:h,options:d}=e;n=await v(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:u,password:h,data:(s=d==null?void 0:d.data)!==null&&s!==void 0?s:{},channel:(i=d==null?void 0:d.channel)!==null&&i!==void 0?i:"sms",gotrue_meta_security:{captcha_token:d==null?void 0:d.captchaToken}},xform:G})}else throw new ze("You must provide either an email or phone number and a password");const{data:a,error:o}=n;if(o||!a)return{data:{user:null,session:null},error:o};const l=a.session,c=a.user;return a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",l)),{data:{user:c,session:l},error:null}}catch(n){if(y(n))return{data:{user:null,session:null},error:n};throw n}}async signInWithPassword(e){try{await this._removeSession();let t;if("email"in e){const{email:n,password:a,options:o}=e;t=await v(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:n,password:a,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},xform:as})}else if("phone"in e){const{phone:n,password:a,options:o}=e;t=await v(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:n,password:a,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},xform:as})}else throw new ze("You must provide either an email or phone number and a password");const{data:s,error:i}=t;return i?{data:{user:null,session:null},error:i}:!s||!s.session||!s.user?{data:{user:null,session:null},error:new ft}:(s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",s.session)),{data:Object.assign({user:s.user,session:s.session},s.weak_password?{weakPassword:s.weak_password}:null),error:i})}catch(t){if(y(t))return{data:{user:null,session:null},error:t};throw t}}async signInWithOAuth(e){var t,s,i,n;return await this._removeSession(),await this._handleProviderSignIn(e.provider,{redirectTo:(t=e.options)===null||t===void 0?void 0:t.redirectTo,scopes:(s=e.options)===null||s===void 0?void 0:s.scopes,queryParams:(i=e.options)===null||i===void 0?void 0:i.queryParams,skipBrowserRedirect:(n=e.options)===null||n===void 0?void 0:n.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(e))}async _exchangeCodeForSession(e){const t=await Ne(this.storage,`${this.storageKey}-code-verifier`),[s,i]=(t??"").split("/"),{data:n,error:a}=await v(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:s},xform:G});return await dt(this.storage,`${this.storageKey}-code-verifier`),a?{data:{user:null,session:null,redirectType:null},error:a}:!n||!n.session||!n.user?{data:{user:null,session:null,redirectType:null},error:new ft}:(n.session&&(await this._saveSession(n.session),await this._notifyAllSubscribers("SIGNED_IN",n.session)),{data:Object.assign(Object.assign({},n),{redirectType:i??null}),error:a})}async signInWithIdToken(e){await this._removeSession();try{const{options:t,provider:s,token:i,access_token:n,nonce:a}=e,o=await v(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:s,id_token:i,access_token:n,nonce:a,gotrue_meta_security:{captcha_token:t==null?void 0:t.captchaToken}},xform:G}),{data:l,error:c}=o;return c?{data:{user:null,session:null},error:c}:!l||!l.session||!l.user?{data:{user:null,session:null},error:new ft}:(l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",l.session)),{data:l,error:c})}catch(t){if(y(t))return{data:{user:null,session:null},error:t};throw t}}async signInWithOtp(e){var t,s,i,n,a;try{if(await this._removeSession(),"email"in e){const{email:o,options:l}=e;let c=null,u=null;this.flowType==="pkce"&&([c,u]=await fe(this.storage,this.storageKey));const{error:h}=await v(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:o,data:(t=l==null?void 0:l.data)!==null&&t!==void 0?t:{},create_user:(s=l==null?void 0:l.shouldCreateUser)!==null&&s!==void 0?s:!0,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken},code_challenge:c,code_challenge_method:u},redirectTo:l==null?void 0:l.emailRedirectTo});return{data:{user:null,session:null},error:h}}if("phone"in e){const{phone:o,options:l}=e,{data:c,error:u}=await v(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:o,data:(i=l==null?void 0:l.data)!==null&&i!==void 0?i:{},create_user:(n=l==null?void 0:l.shouldCreateUser)!==null&&n!==void 0?n:!0,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken},channel:(a=l==null?void 0:l.channel)!==null&&a!==void 0?a:"sms"}});return{data:{user:null,session:null,messageId:c==null?void 0:c.message_id},error:u}}throw new ze("You must provide either an email or phone number.")}catch(o){if(y(o))return{data:{user:null,session:null},error:o};throw o}}async verifyOtp(e){var t,s;try{e.type!=="email_change"&&e.type!=="phone_change"&&await this._removeSession();let i,n;"options"in e&&(i=(t=e.options)===null||t===void 0?void 0:t.redirectTo,n=(s=e.options)===null||s===void 0?void 0:s.captchaToken);const{data:a,error:o}=await v(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:n}}),redirectTo:i,xform:G});if(o)throw o;if(!a)throw new Error("An error occurred on token verification.");const l=a.session,c=a.user;return l!=null&&l.access_token&&(await this._saveSession(l),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",l)),{data:{user:c,session:l},error:null}}catch(i){if(y(i))return{data:{user:null,session:null},error:i};throw i}}async signInWithSSO(e){var t,s,i;try{await this._removeSession();let n=null,a=null;return this.flowType==="pkce"&&([n,a]=await fe(this.storage,this.storageKey)),await v(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(s=(t=e.options)===null||t===void 0?void 0:t.redirectTo)!==null&&s!==void 0?s:void 0}),!((i=e==null?void 0:e.options)===null||i===void 0)&&i.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:n,code_challenge_method:a}),headers:this.headers,xform:aa})}catch(n){if(y(n))return{data:null,error:n};throw n}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:t},error:s}=e;if(s)throw s;if(!t)throw new X;const{error:i}=await v(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:t.access_token});return{data:{user:null,session:null},error:i}})}catch(e){if(y(e))return{data:{user:null,session:null},error:e};throw e}}async resend(e){try{e.type!="email_change"&&e.type!="phone_change"&&await this._removeSession();const t=`${this.url}/resend`;if("email"in e){const{email:s,type:i,options:n}=e,{error:a}=await v(this.fetch,"POST",t,{headers:this.headers,body:{email:s,type:i,gotrue_meta_security:{captcha_token:n==null?void 0:n.captchaToken}},redirectTo:n==null?void 0:n.emailRedirectTo});return{data:{user:null,session:null},error:a}}else if("phone"in e){const{phone:s,type:i,options:n}=e,{data:a,error:o}=await v(this.fetch,"POST",t,{headers:this.headers,body:{phone:s,type:i,gotrue_meta_security:{captcha_token:n==null?void 0:n.captchaToken}}});return{data:{user:null,session:null,messageId:a==null?void 0:a.message_id},error:o}}throw new ze("You must provide either an email or phone number and a type")}catch(t){if(y(t))return{data:{user:null,session:null},error:t};throw t}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async t=>t))}async _acquireLock(e,t){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const s=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),i=(async()=>(await s,await t()))();return this.pendingInLock.push((async()=>{try{await i}catch{}})()),i}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const s=t();for(this.pendingInLock.push((async()=>{try{await s}catch{}})()),await s;this.pendingInLock.length;){const i=[...this.pendingInLock];await Promise.all(i),this.pendingInLock.splice(0,i.length)}return await s}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const t=await this.__loadSession();return await e(t)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const t=await Ne(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",t),t!==null&&(this._isValidSession(t)?e=t:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const s=e.expires_at?e.expires_at<=Date.now()/1e3:!1;if(this._debug("#__loadSession()",`session has${s?"":" not"} expired`,"expires_at",e.expires_at),!s){if(this.storage.isServer){const a=this.suppressGetSessionWarning;e=new Proxy(e,{get(l,c,u){return!a&&c==="user"&&console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and many not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),Reflect.get(l,c,u)}})}return{data:{session:e},error:null}}const{session:i,error:n}=await this._callRefreshToken(e.refresh_token);return n?{data:{session:null},error:n}:{data:{session:i},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(e){return e?await this._getUser(e):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(e){try{return e?await v(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:Z}):await this._useSession(async t=>{var s,i,n;const{data:a,error:o}=t;if(o)throw o;return!(!((s=a.session)===null||s===void 0)&&s.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new X}:await v(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(n=(i=a.session)===null||i===void 0?void 0:i.access_token)!==null&&n!==void 0?n:void 0,xform:Z})})}catch(t){if(y(t))return{data:{user:null},error:t};throw t}}async updateUser(e,t={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,t))}async _updateUser(e,t={}){try{return await this._useSession(async s=>{const{data:i,error:n}=s;if(n)throw n;if(!i.session)throw new X;const a=i.session;let o=null,l=null;this.flowType==="pkce"&&e.email!=null&&([o,l]=await fe(this.storage,this.storageKey));const{data:c,error:u}=await v(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:t==null?void 0:t.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:o,code_challenge_method:l}),jwt:a.access_token,xform:Z});if(u)throw u;return a.user=c.user,await this._saveSession(a),await this._notifyAllSubscribers("USER_UPDATED",a),{data:{user:a.user},error:null}})}catch(s){if(y(s))return{data:{user:null},error:s};throw s}}_decodeJWT(e){return ss(e)}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new X;const t=Date.now()/1e3;let s=t,i=!0,n=null;const a=ss(e.access_token);if(a.exp&&(s=a.exp,i=s<=t),i){const{session:o,error:l}=await this._callRefreshToken(e.refresh_token);if(l)return{data:{user:null,session:null},error:l};if(!o)return{data:{user:null,session:null},error:null};n=o}else{const{data:o,error:l}=await this._getUser(e.access_token);if(l)throw l;n={access_token:e.access_token,refresh_token:e.refresh_token,user:o.user,token_type:"bearer",expires_in:s-t,expires_at:s},await this._saveSession(n),await this._notifyAllSubscribers("SIGNED_IN",n)}return{data:{user:n.user,session:n},error:null}}catch(t){if(y(t))return{data:{session:null,user:null},error:t};throw t}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async t=>{var s;if(!e){const{data:a,error:o}=t;if(o)throw o;e=(s=a.session)!==null&&s!==void 0?s:void 0}if(!(e!=null&&e.refresh_token))throw new X;const{session:i,error:n}=await this._callRefreshToken(e.refresh_token);return n?{data:{user:null,session:null},error:n}:i?{data:{user:i.user,session:i},error:null}:{data:{user:null,session:null},error:null}})}catch(t){if(y(t))return{data:{user:null,session:null},error:t};throw t}}async _getSessionFromURL(e){try{if(!U())throw new Be("No browser detected.");if(this.flowType==="implicit"&&!this._isImplicitGrantFlow())throw new Be("Not a valid implicit grant flow url.");if(this.flowType=="pkce"&&!e)throw new rs("Not a valid PKCE flow url.");const t=ht(window.location.href);if(e){if(!t.code)throw new rs("No code detected.");const{data:S,error:x}=await this._exchangeCodeForSession(t.code);if(x)throw x;const E=new URL(window.location.href);return E.searchParams.delete("code"),window.history.replaceState(window.history.state,"",E.toString()),{data:{session:S.session,redirectType:null},error:null}}if(t.error||t.error_description||t.error_code)throw new Be(t.error_description||"Error in URL with unspecified error_description",{error:t.error||"unspecified_error",code:t.error_code||"unspecified_code"});const{provider_token:s,provider_refresh_token:i,access_token:n,refresh_token:a,expires_in:o,expires_at:l,token_type:c}=t;if(!n||!o||!a||!c)throw new Be("No session defined in URL");const u=Math.round(Date.now()/1e3),h=parseInt(o);let d=u+h;l&&(d=parseInt(l));const f=d-u;f*1e3<=Ae&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${f}s, should have been closer to ${h}s`);const p=d-h;u-p>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",p,d,u):u-p<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clok for skew",p,d,u);const{data:g,error:m}=await this._getUser(n);if(m)throw m;const w={provider_token:s,provider_refresh_token:i,access_token:n,expires_in:h,expires_at:d,refresh_token:a,token_type:c,user:g.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:w,redirectType:t.type},error:null}}catch(t){if(y(t))return{data:{session:null,redirectType:null},error:t};throw t}}_isImplicitGrantFlow(){const e=ht(window.location.href);return!!(U()&&(e.access_token||e.error_description))}async _isPKCEFlow(){const e=ht(window.location.href),t=await Ne(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&t)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async t=>{var s;const{data:i,error:n}=t;if(n)return{error:n};const a=(s=i.session)===null||s===void 0?void 0:s.access_token;if(a){const{error:o}=await this.admin.signOut(a,e);if(o&&!(ta(o)&&(o.status===404||o.status===401||o.status===403)))return{error:o}}return e!=="others"&&(await this._removeSession(),await dt(this.storage,`${this.storageKey}-code-verifier`),await this._notifyAllSubscribers("SIGNED_OUT",null)),{error:null}})}onAuthStateChange(e){const t=Mn(),s={id:t,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",t),this.stateChangeEmitters.delete(t)}};return this._debug("#onAuthStateChange()","registered callback with id",t),this.stateChangeEmitters.set(t,s),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(t)})))(),{data:{subscription:s}}}async _emitInitialSession(e){return await this._useSession(async t=>{var s,i;try{const{data:{session:n},error:a}=t;if(a)throw a;await((s=this.stateChangeEmitters.get(e))===null||s===void 0?void 0:s.callback("INITIAL_SESSION",n)),this._debug("INITIAL_SESSION","callback id",e,"session",n)}catch(n){await((i=this.stateChangeEmitters.get(e))===null||i===void 0?void 0:i.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",n),console.error(n)}})}async resetPasswordForEmail(e,t={}){let s=null,i=null;this.flowType==="pkce"&&([s,i]=await fe(this.storage,this.storageKey,!0));try{return await v(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:s,code_challenge_method:i,gotrue_meta_security:{captcha_token:t.captchaToken}},headers:this.headers,redirectTo:t.redirectTo})}catch(n){if(y(n))return{data:null,error:n};throw n}}async getUserIdentities(){var e;try{const{data:t,error:s}=await this.getUser();if(s)throw s;return{data:{identities:(e=t.user.identities)!==null&&e!==void 0?e:[]},error:null}}catch(t){if(y(t))return{data:null,error:t};throw t}}async linkIdentity(e){var t;try{const{data:s,error:i}=await this._useSession(async n=>{var a,o,l,c,u;const{data:h,error:d}=n;if(d)throw d;const f=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(a=e.options)===null||a===void 0?void 0:a.redirectTo,scopes:(o=e.options)===null||o===void 0?void 0:o.scopes,queryParams:(l=e.options)===null||l===void 0?void 0:l.queryParams,skipBrowserRedirect:!0});return await v(this.fetch,"GET",f,{headers:this.headers,jwt:(u=(c=h.session)===null||c===void 0?void 0:c.access_token)!==null&&u!==void 0?u:void 0})});if(i)throw i;return U()&&!(!((t=e.options)===null||t===void 0)&&t.skipBrowserRedirect)&&window.location.assign(s==null?void 0:s.url),{data:{provider:e.provider,url:s==null?void 0:s.url},error:null}}catch(s){if(y(s))return{data:{provider:e.provider,url:null},error:s};throw s}}async unlinkIdentity(e){try{return await this._useSession(async t=>{var s,i;const{data:n,error:a}=t;if(a)throw a;return await v(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(i=(s=n.session)===null||s===void 0?void 0:s.access_token)!==null&&i!==void 0?i:void 0})})}catch(t){if(y(t))return{data:null,error:t};throw t}}async _refreshAccessToken(e){const t=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(t,"begin");try{const s=Date.now();return await Hn(async i=>(i>0&&await Jn(200*Math.pow(2,i-1)),this._debug(t,"refreshing attempt",i),await v(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:G})),(i,n)=>{const a=200*Math.pow(2,i);return n&&pt(n)&&Date.now()+a-s<Ae})}catch(s){if(this._debug(t,"error",s),y(s))return{data:{session:null,user:null},error:s};throw s}finally{this._debug(t,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,t){const s=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:t.redirectTo,scopes:t.scopes,queryParams:t.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",t,"url",s),U()&&!t.skipBrowserRedirect&&window.location.assign(s),{data:{provider:e,url:s},error:null}}async _recoverAndRefresh(){var e;const t="#_recoverAndRefresh()";this._debug(t,"begin");try{const s=await Ne(this.storage,this.storageKey);if(this._debug(t,"session from storage",s),!this._isValidSession(s)){this._debug(t,"session is not valid"),s!==null&&await this._removeSession();return}const i=Math.round(Date.now()/1e3),n=((e=s.expires_at)!==null&&e!==void 0?e:1/0)<i+ts;if(this._debug(t,`session has${n?"":" not"} expired with margin of ${ts}s`),n){if(this.autoRefreshToken&&s.refresh_token){const{error:a}=await this._callRefreshToken(s.refresh_token);a&&(console.error(a),pt(a)||(this._debug(t,"refresh failed with a non-retryable error, removing the session",a),await this._removeSession()))}}else await this._notifyAllSubscribers("SIGNED_IN",s)}catch(s){this._debug(t,"error",s),console.error(s);return}finally{this._debug(t,"end")}}async _callRefreshToken(e){var t,s;if(!e)throw new X;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const i=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(i,"begin");try{this.refreshingDeferred=new nt;const{data:n,error:a}=await this._refreshAccessToken(e);if(a)throw a;if(!n.session)throw new X;await this._saveSession(n.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",n.session);const o={session:n.session,error:null};return this.refreshingDeferred.resolve(o),o}catch(n){if(this._debug(i,"error",n),y(n)){const a={session:null,error:n};return pt(n)||(await this._removeSession(),await this._notifyAllSubscribers("SIGNED_OUT",null)),(t=this.refreshingDeferred)===null||t===void 0||t.resolve(a),a}throw(s=this.refreshingDeferred)===null||s===void 0||s.reject(n),n}finally{this.refreshingDeferred=null,this._debug(i,"end")}}async _notifyAllSubscribers(e,t,s=!0){const i=`#_notifyAllSubscribers(${e})`;this._debug(i,"begin",t,`broadcast = ${s}`);try{this.broadcastChannel&&s&&this.broadcastChannel.postMessage({event:e,session:t});const n=[],a=Array.from(this.stateChangeEmitters.values()).map(async o=>{try{await o.callback(e,t)}catch(l){n.push(l)}});if(await Promise.all(a),n.length>0){for(let o=0;o<n.length;o+=1)console.error(n[o]);throw n[0]}}finally{this._debug(i,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0,await Vs(this.storage,this.storageKey,e)}async _removeSession(){this._debug("#_removeSession()"),await dt(this.storage,this.storageKey)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&U()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",e)}catch(t){console.error("removing visibilitychange callback failed",t)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),Ae);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async t=>{const{data:{session:s}}=t;if(!s||!s.refresh_token||!s.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const i=Math.floor((s.expires_at*1e3-e)/Ae);this._debug("#_autoRefreshTokenTick()",`access token expires in ${i} ticks, a tick lasts ${Ae}ms, refresh threshold is ${ls} ticks`),i<=ls&&await this._callRefreshToken(s.refresh_token)})}catch(t){console.error("Auto refresh tick failed with error. This is likely a transient error.",t)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof Hs)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!U()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const t=`#_onVisibilityChanged(${e})`;this._debug(t,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(t,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,t,s){const i=[`provider=${encodeURIComponent(t)}`];if(s!=null&&s.redirectTo&&i.push(`redirect_to=${encodeURIComponent(s.redirectTo)}`),s!=null&&s.scopes&&i.push(`scopes=${encodeURIComponent(s.scopes)}`),this.flowType==="pkce"){const[n,a]=await fe(this.storage,this.storageKey),o=new URLSearchParams({code_challenge:`${encodeURIComponent(n)}`,code_challenge_method:`${encodeURIComponent(a)}`});i.push(o.toString())}if(s!=null&&s.queryParams){const n=new URLSearchParams(s.queryParams);i.push(n.toString())}return s!=null&&s.skipBrowserRedirect&&i.push(`skip_http_redirect=${s.skipBrowserRedirect}`),`${e}?${i.join("&")}`}async _unenroll(e){try{return await this._useSession(async t=>{var s;const{data:i,error:n}=t;return n?{data:null,error:n}:await v(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(s=i==null?void 0:i.session)===null||s===void 0?void 0:s.access_token})})}catch(t){if(y(t))return{data:null,error:t};throw t}}async _enroll(e){try{return await this._useSession(async t=>{var s,i;const{data:n,error:a}=t;if(a)return{data:null,error:a};const{data:o,error:l}=await v(this.fetch,"POST",`${this.url}/factors`,{body:{friendly_name:e.friendlyName,factor_type:e.factorType,issuer:e.issuer},headers:this.headers,jwt:(s=n==null?void 0:n.session)===null||s===void 0?void 0:s.access_token});return l?{data:null,error:l}:(!((i=o==null?void 0:o.totp)===null||i===void 0)&&i.qr_code&&(o.totp.qr_code=`data:image/svg+xml;utf-8,${o.totp.qr_code}`),{data:o,error:null})})}catch(t){if(y(t))return{data:null,error:t};throw t}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var s;const{data:i,error:n}=t;if(n)return{data:null,error:n};const{data:a,error:o}=await v(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:{code:e.code,challenge_id:e.challengeId},headers:this.headers,jwt:(s=i==null?void 0:i.session)===null||s===void 0?void 0:s.access_token});return o?{data:null,error:o}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+a.expires_in},a)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",a),{data:a,error:o})})}catch(t){if(y(t))return{data:null,error:t};throw t}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var s;const{data:i,error:n}=t;return n?{data:null,error:n}:await v(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{headers:this.headers,jwt:(s=i==null?void 0:i.session)===null||s===void 0?void 0:s.access_token})})}catch(t){if(y(t))return{data:null,error:t};throw t}})}async _challengeAndVerify(e){const{data:t,error:s}=await this._challenge({factorId:e.factorId});return s?{data:null,error:s}:await this._verify({factorId:e.factorId,challengeId:t.id,code:e.code})}async _listFactors(){const{data:{user:e},error:t}=await this.getUser();if(t)return{data:null,error:t};const s=(e==null?void 0:e.factors)||[],i=s.filter(n=>n.factor_type==="totp"&&n.status==="verified");return{data:{all:s,totp:i},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async e=>{var t,s;const{data:{session:i},error:n}=e;if(n)return{data:null,error:n};if(!i)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const a=this._decodeJWT(i.access_token);let o=null;a.aal&&(o=a.aal);let l=o;((s=(t=i.user.factors)===null||t===void 0?void 0:t.filter(h=>h.status==="verified"))!==null&&s!==void 0?s:[]).length>0&&(l="aal2");const u=a.amr||[];return{data:{currentLevel:o,nextLevel:l,currentAuthenticationMethods:u},error:null}}))}}Ie.nextInstanceID=0;const ya=Ie;class va extends ya{constructor(e){super(e)}}var _a=function(r,e,t,s){function i(n){return n instanceof t?n:new t(function(a){a(n)})}return new(t||(t=Promise))(function(n,a){function o(u){try{c(s.next(u))}catch(h){a(h)}}function l(u){try{c(s.throw(u))}catch(h){a(h)}}function c(u){u.done?n(u.value):i(u.value).then(o,l)}c((s=s.apply(r,e||[])).next())})};class ba{constructor(e,t,s){var i,n,a;if(this.supabaseUrl=e,this.supabaseKey=t,!e)throw new Error("supabaseUrl is required.");if(!t)throw new Error("supabaseKey is required.");const o=Dn(e);this.realtimeUrl=`${o}/realtime/v1`.replace(/^http/i,"ws"),this.authUrl=`${o}/auth/v1`,this.storageUrl=`${o}/storage/v1`,this.functionsUrl=`${o}/functions/v1`;const l=`sb-${new URL(this.authUrl).hostname.split(".")[0]}-auth-token`,c={db:An,realtime:Cn,auth:Object.assign(Object.assign({},jn),{storageKey:l}),global:xn},u=Ln(s??{},c);this.storageKey=(i=u.auth.storageKey)!==null&&i!==void 0?i:"",this.headers=(n=u.global.headers)!==null&&n!==void 0?n:{},this.auth=this._initSupabaseAuthClient((a=u.auth)!==null&&a!==void 0?a:{},this.headers,u.global.fetch),this.fetch=Fn(t,this._getAccessToken.bind(this),u.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers},u.realtime)),this.rest=new Yi(`${o}/rest/v1`,{headers:this.headers,schema:u.db.schema,fetch:this.fetch}),this._listenForAuthEvents()}get functions(){return new Ti(this.functionsUrl,{headers:this.headers,customFetch:this.fetch})}get storage(){return new En(this.storageUrl,this.headers,this.fetch)}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,t={},s={}){return this.rest.rpc(e,t,s)}channel(e,t={config:{}}){return this.realtime.channel(e,t)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var e,t;return _a(this,void 0,void 0,function*(){const{data:s}=yield this.auth.getSession();return(t=(e=s.session)===null||e===void 0?void 0:e.access_token)!==null&&t!==void 0?t:null})}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:t,detectSessionInUrl:s,storage:i,storageKey:n,flowType:a,debug:o},l,c){var u;const h={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new va({url:this.authUrl,headers:Object.assign(Object.assign({},h),l),storageKey:n,autoRefreshToken:e,persistSession:t,detectSessionInUrl:s,storage:i,flowType:a,debug:o,fetch:c,hasCustomAuthorizationHeader:(u="Authorization"in this.headers)!==null&&u!==void 0?u:!1})}_initRealtimeClient(e){return new dn(this.realtimeUrl,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},e==null?void 0:e.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((t,s)=>{this._handleTokenChanged(t,"CLIENT",s==null?void 0:s.access_token)})}_handleTokenChanged(e,t,s){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==s?(this.realtime.setAuth(s??null),this.changedAccessToken=s):e==="SIGNED_OUT"&&(this.realtime.setAuth(this.supabaseKey),t=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const wa=(r,e,t)=>new ba(r,e,t),ka="https://eledpgyadtqqiwwevuff.supabase.co",Sa="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImVsZWRwZ3lhZHRxcWl3d2V2dWZmIiwicm9sZSI6ImFub24iLCJpYXQiOjE3MjA4MDA3MDgsImV4cCI6MjAzNjM3NjcwOH0.KdLoaz3TAosuq4sHKWnsLaf77YPXNGCIP_hDqgGqc30",La=wa(ka,Sa);export{Oa as _,fi as a,Ta as b,wi as c,xa as d,La as s};
